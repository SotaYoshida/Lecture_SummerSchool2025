
<!DOCTYPE html>


<html lang="ja" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Copyright 2020 The Cirq Developers &#8212; Julia言語による原子核構造計算入門</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../_static/documentation_options.js?v=1cf7f4d9"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../../_static/translations.js?v=91613774"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'myenv/openfermion/docs/tutorials/intro_workshop_exercises';</script>
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="検索" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ja"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">本文へスキップ</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>トップに戻る</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="バージョン警告"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../home.html">
  
  
  
  
  
  
    <p class="title logo__title">Julia言語による原子核構造計算入門</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">検索</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../home.html">
                    講義の狙いと資料の概要
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">pairing Hamiltonianと多体計算手法</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Hamiltonian.html">1. pairing Hamiltonian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/FullCI.html">2. Full-CI/厳密対角化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/HartreeFock.html">3. Hartree-Fock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/BCS.html">4. BCS (Bardeen-Cooper-Schrieffer)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/MBPT.html">5. Many-Body Perturbation Theory (MBPT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/CoupledCluster.html">6. Coupled Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/IMSRG.html">7. In-medium Similarity Renormalization Group (IM-SRG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/EC.html">8. Emulator/Surrogate model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">量子計算</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/QuantumComputing.html">9. Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Pairing_VQE_pennylane.html">10. Pairing HamiltonianのVQE計算 (Pennylane)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/qpe_pennylane.html">11. Pairing HamiltonianのQPE計算 (Pennylane)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Pairing_VQE_pytket.html">12. Pairing Hamiltonianの量子計算 (pytket)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SotaYoshida/Lecture_SummerSchool2025" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="ソースリポジトリ"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SotaYoshida/Lecture_SummerSchool2025/issues/new?title=Issue%20on%20page%20%2Fmyenv/openfermion/docs/tutorials/intro_workshop_exercises.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="問題を報告"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="このページをダウンロード">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/myenv/openfermion/docs/tutorials/intro_workshop_exercises.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="ソースファイルをダウンロード"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDFに印刷"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全画面モード"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="ライト"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="ダーク"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Copyright 2020 The Cirq Developers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目次 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Copyright 2020 The Cirq Developers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-simulation-of-electronic-structure">Quantum simulation of electronic structure</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fermionoperator-and-qubitoperator">FermionOperator and QubitOperator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#openfermion-fermionoperator"><code class="docutils literal notranslate"><span class="pre">openfermion.FermionOperator</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#openfermion-qubitoperator"><code class="docutils literal notranslate"><span class="pre">openfermion.QubitOperator</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-jordan-wigner-and-bravyi-kitaev-transforms">The Jordan-Wigner and Bravyi-Kitaev transforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Solution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-data-structures">Array data structures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interactionoperator">InteractionOperator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagonalcoulombhamiltonian">DiagonalCoulombHamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quadratichamiltonian">QuadraticHamiltonian</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-the-hamiltonian-for-a-molecule">Generating the Hamiltonian for a molecule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian-simulation-with-trotter-formulas">Hamiltonian simulation with Trotter formulas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bogoliubov-transformation">Bogoliubov transformation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="copyright-2020-the-cirq-developers">
<h1>Copyright 2020 The Cirq Developers<a class="headerlink" href="#copyright-2020-the-cirq-developers" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># @title Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="quantum-simulation-of-electronic-structure">
<h1>Quantum simulation of electronic structure<a class="headerlink" href="#quantum-simulation-of-electronic-structure" title="Link to this heading">#</a></h1>
<table class="tfo-notebook-buttons" align="left">
  <td>
    <a target="_blank" href="https://quantumai.google/openfermion/tutorials/intro_workshop_exercises"><img src="https://quantumai.google/site-assets/images/buttons/quantumai_logo_1x.png" />View on QuantumAI</a>
  </td>
  <td>
    <a target="_blank" href="https://colab.research.google.com/github/quantumlib/OpenFermion/blob/master/docs/tutorials/intro_workshop_exercises.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/colab_logo_1x.png" />Run in Google Colab</a>
  </td>
  <td>
    <a target="_blank" href="https://github.com/quantumlib/OpenFermion/blob/master/docs/tutorials/intro_workshop_exercises.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/github_logo_1x.png" />View source on GitHub</a>
  </td>
  <td>
    <a href="https://storage.googleapis.com/tensorflow_docs/OpenFermion/docs/tutorials/intro_workshop_exercises.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/download_icon_1x.png" />Download notebook</a>
  </td>
</table><p>The quantum simulation of electronic structure is one of the most promising applications of quantum computers. It has potential applications to materials and drug design. This tutorial provides an introduction to OpenFermion, a library for obtaining and manipulating representations of fermionic and qubit Hamiltonians as well as compiling quantum simulation circuits in Cirq.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>try:
    import openfermion as of
    import openfermionpyscf as ofpyscf
except ImportError:
    print(&quot;Installing OpenFermion and OpenFermion-PySCF...&quot;)
    !pip install openfermion openfermionpyscf --quiet
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import numpy as np
from scipy.sparse import linalg

import cirq
import openfermion as of
import openfermionpyscf as ofpyscf
</pre></div>
</div>
</div>
</div>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<p>A system of <span class="math notranslate nohighlight">\(N\)</span> fermionic modes is
described by a set of fermionic <em>annihilation operators</em>
<span class="math notranslate nohighlight">\(\{a_p\}_{p=0}^{N-1}\)</span> satisfying the <em>canonical anticommutation relations</em>
$<span class="math notranslate nohighlight">\(\begin{aligned}
    \{a_p, a_q\} &amp;= 0, \\
    \{a_p, a^\dagger_q\} &amp;= \delta_{pq},
  \end{aligned}\)</span><span class="math notranslate nohighlight">\( where \)</span>{A, B} := AB + BA<span class="math notranslate nohighlight">\(. The adjoint
\)</span>a^\dagger_p<span class="math notranslate nohighlight">\( of an annihilation operator \)</span>a_p$ is called a <em>creation
operator</em>, and we refer to creation and annihilation operators as
fermionic <em>ladder operators</em>.</p>
<p>The canonical anticommutation relations impose a number of consequences on the structure of the vector space on which the ladder operators act; see <a class="reference external" href="http://michaelnielsen.org/blog/archive/notes/fermions_and_jordan_wigner.pdf">Michael Nielsen's notes</a> for a good discussion.</p>
<p>The electronic structure Hamiltonian is commonly written in the form
$<span class="math notranslate nohighlight">\(
\sum_{pq} T_{pq} a_p^\dagger a_q + \sum_{pqrs} V_{pqrs} a_p^\dagger a_q^\dagger a_r a_s
\)</span><span class="math notranslate nohighlight">\(
where the \)</span>T_{pq}<span class="math notranslate nohighlight">\( and \)</span>V_{pqrs}$ are coefficients which depend on the physical system being described. We are interested in calculating the lowest eigenvalue of the Hamiltonian. This eigenvalue is also called the ground state energy.</p>
</section>
<section id="fermionoperator-and-qubitoperator">
<h2>FermionOperator and QubitOperator<a class="headerlink" href="#fermionoperator-and-qubitoperator" title="Link to this heading">#</a></h2>
<section id="openfermion-fermionoperator">
<h3><code class="docutils literal notranslate"><span class="pre">openfermion.FermionOperator</span></code><a class="headerlink" href="#openfermion-fermionoperator" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Stores a weighted sum (linear combination) of fermionic terms</p></li>
<li><p>A fermionic term is a product of ladder operators</p></li>
<li><p>Examples of things that can be represented by <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code>:
$<span class="math notranslate nohighlight">\(
\begin{align}
&amp; a_1 \nonumber \\
&amp; 1.7 a^\dagger_3 \nonumber \\
&amp;-1.7 \, a^\dagger_3 a_1 \nonumber \\
&amp;(1 + 2i) \, a^\dagger_4 a^\dagger_3 a_9 a_1 \nonumber \\
&amp;(1 + 2i) \, a^\dagger_4 a^\dagger_3 a_9 a_1 - 1.7 \, a^\dagger_3 a_1 \nonumber
\end{align}
\)</span>$</p></li>
<li><p>A fermionic term is internally represented as a tuple of tuples</p></li>
<li><p>Each inner tuple represents a single ladder operator as (index, action)</p></li>
<li><p>Examples of fermionic terms:
$<span class="math notranslate nohighlight">\(
\begin{align}
I &amp; \mapsto () \nonumber \\
a_1 &amp; \mapsto ((1, 0),) \nonumber \\
a^\dagger_3 &amp; \mapsto ((3, 1),) \nonumber \\
a^\dagger_3 a_1 &amp; \mapsto ((3, 1), (1, 0)) \nonumber \\
a^\dagger_4 a^\dagger_3 a_9 a_1 &amp; \mapsto ((4, 1), (3, 1), (9, 0), (1, 0)) \nonumber
\end{align}
\)</span>$</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code> is a sum of terms, represented as a dictionary from term to coefficient</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>op = of.FermionOperator(((4, 1), (3, 1), (9, 0), (1, 0)), 1 + 2j) + of.FermionOperator(
    ((3, 1), (1, 0)), -1.7
)

print(op.terms)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{((4, 1), (3, 1), (9, 0), (1, 0)): (1+2j), ((3, 1), (1, 0)): -1.7}
</pre></div>
</div>
</div>
</div>
<p>Alternative notation, useful when playing around:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
I &amp; \mapsto \textrm{&quot;&quot;} \nonumber \\
a_1 &amp; \mapsto \textrm{&quot;1&quot;} \nonumber \\
a^\dagger_3 &amp; \mapsto \textrm{&quot;3^&quot;} \nonumber \\
a^\dagger_3 a_1 &amp; \mapsto \textrm{&quot;3^}\;\textrm{1&quot;} \nonumber \\
a^\dagger_4 a^\dagger_3 a_9 a_1 &amp; \mapsto \textrm{&quot;4^}\;\textrm{3^}\;\textrm{9}\;\textrm{1&quot;} \nonumber
\end{align}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>op = of.FermionOperator(&quot;4^ 3^ 9 1&quot;, 1 + 2j) + of.FermionOperator(&quot;3^ 1&quot;, -1.7)

print(op.terms)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{((4, 1), (3, 1), (9, 0), (1, 0)): (1+2j), ((3, 1), (1, 0)): -1.7}
</pre></div>
</div>
</div>
</div>
<p>Just print the operator for a nice readable representation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>print(op)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.7 [3^ 1] +
(1+2j) [4^ 3^ 9 1]
</pre></div>
</div>
</div>
</div>
</section>
<section id="openfermion-qubitoperator">
<h3><code class="docutils literal notranslate"><span class="pre">openfermion.QubitOperator</span></code><a class="headerlink" href="#openfermion-qubitoperator" title="Link to this heading">#</a></h3>
<p>Same as <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code>, but the possible actions are 'X', 'Y', and 'Z' instead of 1 and 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>op = of.QubitOperator(((1, &quot;X&quot;), (2, &quot;Y&quot;), (3, &quot;Z&quot;)))
op += of.QubitOperator(&quot;X3 Z4&quot;, 3.0)

print(op)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0 [X1 Y2 Z3] +
3.0 [X3 Z4]
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code> and <code class="docutils literal notranslate"><span class="pre">QubitOperator</span></code> actually inherit from the same parent class: <code class="docutils literal notranslate"><span class="pre">openfermion.SymbolicOperator</span></code>.</p>
</section>
</section>
<section id="the-jordan-wigner-and-bravyi-kitaev-transforms">
<h2>The Jordan-Wigner and Bravyi-Kitaev transforms<a class="headerlink" href="#the-jordan-wigner-and-bravyi-kitaev-transforms" title="Link to this heading">#</a></h2>
<p>A fermionic transform maps <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code>s to <code class="docutils literal notranslate"><span class="pre">QubitOperator</span></code>s in a way that preserves the canonical anticommutation relations. The most basic transforms are the Jordan-Wigner transform (JWT) and Bravyi-Kitaev transform (BKT). Note that the BKT requires the total number of qubits to be predetermined. Whenever a fermionic transform is being applied implicitly, it is the JWT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>op = of.FermionOperator(&quot;2^ 15&quot;)

print(of.jordan_wigner(op))
print()
print(of.bravyi_kitaev(op, n_qubits=16))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.25+0j) [X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Z13 Z14 X15] +
0.25j [X2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Z13 Z14 Y15] +
-0.25j [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Z13 Z14 X15] +
(0.25+0j) [Y2 Z3 Z4 Z5 Z6 Z7 Z8 Z9 Z10 Z11 Z12 Z13 Z14 Y15]

(-0.25+0j) [Z1 X2 X3 X7 Z15] +
-0.25j [Z1 X2 X3 Y7 Z11 Z13 Z14] +
0.25j [Z1 Y2 X3 X7 Z15] +
(-0.25+0j) [Z1 Y2 X3 Y7 Z11 Z13 Z14]
</pre></div>
</div>
</div>
</div>
<section id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h3>
<p>Below are some examples of how <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code>s are mapped to <code class="docutils literal notranslate"><span class="pre">QubitOperator</span></code>s by the Jordan-Wigner transform (the notation 'h.c.' stands for 'hermitian conjugate'):
$<span class="math notranslate nohighlight">\(
\begin{align*}
    a_p^\dagger &amp;\mapsto \frac12 (X_p - i Y_p) Z_0 \cdots Z_{p-1}\\
    a_p^\dagger a_p &amp;\mapsto \frac12 (I - Z_p)\\
    (\beta a_p^\dagger a_q + \text{h.c.}) &amp;\mapsto \frac12 [\text{Re}(\beta) (X_p ZZ \cdots ZZ X_q + Y_p ZZ \cdots ZZ Y_q) + \text{Im}(\beta) (Y_p ZZ \cdots ZZ X_q - X_p ZZ \cdots ZZ Y_q)]
\end{align*}
\)</span><span class="math notranslate nohighlight">\(
Verify these mappings for \)</span>p=2<span class="math notranslate nohighlight">\( and \)</span>q=7$. The <code class="docutils literal notranslate"><span class="pre">openfermion.hermitian_conjugated</span></code> function may be useful here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a2 = of.FermionOperator(&quot;2&quot;)
print(of.jordan_wigner(a2))
print()

a2dag = of.FermionOperator(&quot;2^&quot;)
print(of.jordan_wigner(a2dag * a2))
print()

a7 = of.FermionOperator(&quot;7&quot;)
a7dag = of.FermionOperator(&quot;7^&quot;)
print(of.jordan_wigner((1 + 2j) * (a2dag * a7) + (1 - 2j) * (a7dag * a2)))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5 [Z0 Z1 X2] +
0.5j [Z0 Z1 Y2]

(0.5+0j) [] +
(-0.5+0j) [Z2]

(0.5+0j) [X2 Z3 Z4 Z5 Z6 X7] +
(-1+0j) [X2 Z3 Z4 Z5 Z6 Y7] +
(1+0j) [Y2 Z3 Z4 Z5 Z6 X7] +
(0.5+0j) [Y2 Z3 Z4 Z5 Z6 Y7]
</pre></div>
</div>
</div>
</div>
</section>
<section id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a2 = of.FermionOperator(&quot;2&quot;)
a2dag = of.FermionOperator(&quot;2^&quot;)
a7 = of.FermionOperator(&quot;7&quot;)
a7dag = of.FermionOperator(&quot;7^&quot;)

print(of.jordan_wigner(a2dag))
print()
print(of.jordan_wigner(a2dag * a2))
print()

op = (2 + 3j) * a2dag * a7
op += of.hermitian_conjugated(op)
print(of.jordan_wigner(op))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5 [Z0 Z1 X2] +
-0.5j [Z0 Z1 Y2]

(0.5+0j) [] +
(-0.5+0j) [Z2]

(1+0j) [X2 Z3 Z4 Z5 Z6 X7] +
(-1.5+0j) [X2 Z3 Z4 Z5 Z6 Y7] +
(1.5+0j) [Y2 Z3 Z4 Z5 Z6 X7] +
(1+0j) [Y2 Z3 Z4 Z5 Z6 Y7]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>Exercise<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">+</span></code> and <code class="docutils literal notranslate"><span class="pre">*</span></code> operators to verify that after applying the JWT to ladder operators, the resulting <code class="docutils literal notranslate"><span class="pre">QubitOperator</span></code>s satisfy
$<span class="math notranslate nohighlight">\(
\begin{align}
    a_2 a_7 + a_7 a_2 &amp;= 0 \\
    a_2 a_7^\dagger + a_7^\dagger a_2 &amp;= 0\\
    a_2 a_2^\dagger + a_2^\dagger a_2 &amp;= 1
\end{align}
\)</span>$</p>
</section>
<section id="id2">
<h3>Solution<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a2_jw = of.jordan_wigner(a2)
a2dag_jw = of.jordan_wigner(a2dag)
a7_jw = of.jordan_wigner(a7)
a7dag_jw = of.jordan_wigner(a7dag)

print(a2_jw * a7_jw + a7_jw * a2_jw)
print(a2_jw * a7dag_jw + a7dag_jw * a2_jw)
print(a2_jw * a2dag_jw + a2dag_jw * a2_jw)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
0
(1+0j) []
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="array-data-structures">
<h2>Array data structures<a class="headerlink" href="#array-data-structures" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code>s have specialized structure we can store coefficients in numpy arrays, enabling fast numerical manipulation.</p></li>
<li><p>Array data structures can always be converted to <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code> using <code class="docutils literal notranslate"><span class="pre">openfermion.get_fermion_operator</span></code>.</p></li>
</ul>
<section id="interactionoperator">
<h3>InteractionOperator<a class="headerlink" href="#interactionoperator" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Stores the one- and two-body tensors <span class="math notranslate nohighlight">\(T_{pq}\)</span> and <span class="math notranslate nohighlight">\(V_{pqrs}\)</span> of the molecular Hamiltonian</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\sum_{pq} T_{pq} a_p^\dagger a_q + \sum_{pqrs} V_{pqrs} a_p^\dagger a_q^\dagger a_r a_s
\]</div>
<ul class="simple">
<li><p>Default data structure for molecular Hamiltonians</p></li>
<li><p>Convert from <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code> using <code class="docutils literal notranslate"><span class="pre">openfermion.get_interaction_operator</span></code></p></li>
</ul>
</section>
<section id="diagonalcoulombhamiltonian">
<h3>DiagonalCoulombHamiltonian<a class="headerlink" href="#diagonalcoulombhamiltonian" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Stores the one- and two-body coefficient matrices <span class="math notranslate nohighlight">\(T_{pq}\)</span> and <span class="math notranslate nohighlight">\(V_{pq}\)</span> of a Hamiltonian with a diagonal Coulomb term:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\sum_{pq} T_{pq} a_p^\dagger a_q + \sum_{pq} V_{pq} a_p^\dagger a_p a_q^\dagger a_q
\]</div>
<ul class="simple">
<li><p>Leads to especially efficient algorithms for quantum simulation</p></li>
<li><p>Convert from <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code> using <code class="docutils literal notranslate"><span class="pre">openfermion.get_diagonal_coulomb_hamiltonian</span></code></p></li>
</ul>
</section>
<section id="quadratichamiltonian">
<h3>QuadraticHamiltonian<a class="headerlink" href="#quadratichamiltonian" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Stores the Hermitian matrix <span class="math notranslate nohighlight">\(M_{pq}\)</span> and antisymmetric matrix <span class="math notranslate nohighlight">\(\Delta_{pq}\)</span> describing a general quadratic Hamiltonian</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\sum_{p, q} M_{pq} a^\dagger_p a_q + \frac12 \sum_{p, q} (\Delta_{pq} a^\dagger_p a^\dagger_q + \text{h.c.})
\]</div>
<ul class="simple">
<li><p>Routines included for efficient diagonalization (can handle thousands of fermionic modes)</p></li>
<li><p>Convert from <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code> using <code class="docutils literal notranslate"><span class="pre">openfermion.get_quadratic_hamiltonian</span></code></p></li>
</ul>
</section>
</section>
<section id="generating-the-hamiltonian-for-a-molecule">
<h2>Generating the Hamiltonian for a molecule<a class="headerlink" href="#generating-the-hamiltonian-for-a-molecule" title="Link to this heading">#</a></h2>
<p>The cell below demonstrates using one of our electronic structure package plugins, OpenFermion-PySCF, to generate a molecular Hamiltonian for a hydrogen molecule. Note that the Hamiltonian is returned as an <code class="docutils literal notranslate"><span class="pre">InteractionOperator</span></code>. We'll convert it to a <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code> and print the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Set molecule parameters
geometry = [(&quot;H&quot;, (0.0, 0.0, 0.0)), (&quot;H&quot;, (0.0, 0.0, 0.8))]
basis = &quot;sto-3g&quot;
multiplicity = 1
charge = 0

# Perform electronic structure calculations and
# obtain Hamiltonian as an InteractionOperator
hamiltonian = ofpyscf.generate_molecular_hamiltonian(
    geometry, basis, multiplicity, charge
)

# Convert to a FermionOperator
hamiltonian_ferm_op = of.get_fermion_operator(hamiltonian)

print(hamiltonian_ferm_op)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.66147151365 [] +
-1.2178260299951058 [0^ 0] +
0.3316650744318082 [0^ 0^ 0 0] +
0.09231339177803066 [0^ 0^ 2 2] +
0.3316650744318082 [0^ 1^ 1 0] +
0.09231339177803066 [0^ 1^ 3 2] +
0.09231339177803066 [0^ 2^ 0 2] +
0.3267206861819477 [0^ 2^ 2 0] +
0.09231339177803066 [0^ 3^ 1 2] +
0.3267206861819477 [0^ 3^ 3 0] +
0.3316650744318082 [1^ 0^ 0 1] +
0.09231339177803066 [1^ 0^ 2 3] +
-1.2178260299951058 [1^ 1] +
0.3316650744318082 [1^ 1^ 1 1] +
0.09231339177803066 [1^ 1^ 3 3] +
0.09231339177803066 [1^ 2^ 0 3] +
0.3267206861819477 [1^ 2^ 2 1] +
0.09231339177803066 [1^ 3^ 1 3] +
0.3267206861819477 [1^ 3^ 3 1] +
0.32672068618194783 [2^ 0^ 0 2] +
0.09231339177803066 [2^ 0^ 2 0] +
0.32672068618194783 [2^ 1^ 1 2] +
0.09231339177803066 [2^ 1^ 3 0] +
-0.5096378744364826 [2^ 2] +
0.09231339177803066 [2^ 2^ 0 0] +
0.34339576784573445 [2^ 2^ 2 2] +
0.09231339177803066 [2^ 3^ 1 0] +
0.34339576784573445 [2^ 3^ 3 2] +
0.32672068618194783 [3^ 0^ 0 3] +
0.09231339177803066 [3^ 0^ 2 1] +
0.32672068618194783 [3^ 1^ 1 3] +
0.09231339177803066 [3^ 1^ 3 1] +
0.09231339177803066 [3^ 2^ 0 1] +
0.34339576784573445 [3^ 2^ 2 3] +
-0.5096378744364826 [3^ 3] +
0.09231339177803066 [3^ 3^ 1 1] +
0.34339576784573445 [3^ 3^ 3 3]
</pre></div>
</div>
</div>
</div>
<p>Let's calculate the ground energy (lowest eigenvalue) of the Hamiltonian. First, we'll map the <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code> to a <code class="docutils literal notranslate"><span class="pre">QubitOperator</span></code> using the JWT. Then, we'll convert the <code class="docutils literal notranslate"><span class="pre">QubitOperator</span></code> to a SciPy sparse matrix and get its lowest eigenvalue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Map to QubitOperator using the JWT
hamiltonian_jw = of.jordan_wigner(hamiltonian_ferm_op)

# Convert to Scipy sparse matrix
hamiltonian_jw_sparse = of.get_sparse_operator(hamiltonian_jw)

# Compute ground energy
eigs, _ = linalg.eigsh(hamiltonian_jw_sparse, k=1, which=&quot;SA&quot;)
ground_energy = eigs[0]

print(&quot;Ground_energy: {}&quot;.format(ground_energy))
print(&quot;JWT transformed Hamiltonian:&quot;)
print(hamiltonian_jw)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground_energy: -1.134147666677095
JWT transformed Hamiltonian:
(-0.16733398905695201+0j) [] +
(-0.04615669588901533+0j) [X0 X1 Y2 Y3] +
(0.04615669588901533+0j) [X0 Y1 Y2 X3] +
(0.04615669588901533+0j) [Y0 X1 X2 Y3] +
(-0.04615669588901533+0j) [Y0 Y1 X2 X3] +
(0.16251648748871642+0j) [Z0] +
(0.1658325372159041+0j) [Z0 Z1] +
(0.11720364720195856+0j) [Z0 Z2] +
(0.1633603430909739+0j) [Z0 Z3] +
(0.16251648748871636+0j) [Z1] +
(0.1633603430909739+0j) [Z1 Z2] +
(0.11720364720195856+0j) [Z1 Z3] +
(-0.1974429369975584+0j) [Z2] +
(0.17169788392286722+0j) [Z2 Z3] +
(-0.19744293699755838+0j) [Z3]
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h3>Exercise<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Compute the ground energy of the same Hamiltonian, but via the Bravyi-Kitaev transform. Verify that you get the same value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Map to QubitOperator using the JWT
hamiltonian_bk = of.bravyi_kitaev(hamiltonian_ferm_op)

# Convert to Scipy sparse matrix
hamiltonian_bk_sparse = of.get_sparse_operator(hamiltonian_bk)

# Compute ground energy
eigs, _ = linalg.eigsh(hamiltonian_bk_sparse, k=1, which=&quot;SA&quot;)
ground_energy = eigs[0]

print(&quot;Ground_energy: {}&quot;.format(ground_energy))
print(&quot;BK transformed Hamiltonian:&quot;)
print(hamiltonian_bk)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground_energy: -1.1341476666770918
BK transformed Hamiltonian:
(-0.16733398905695201+0j) [] +
(0.04615669588901533+0j) [X0 Z1 X2] +
(0.04615669588901533+0j) [X0 Z1 X2 Z3] +
(0.04615669588901533+0j) [Y0 Z1 Y2] +
(0.04615669588901533+0j) [Y0 Z1 Y2 Z3] +
(0.16251648748871642+0j) [Z0] +
(0.16251648748871636+0j) [Z0 Z1] +
(0.1633603430909739+0j) [Z0 Z1 Z2] +
(0.1633603430909739+0j) [Z0 Z1 Z2 Z3] +
(0.11720364720195856+0j) [Z0 Z2] +
(0.11720364720195856+0j) [Z0 Z2 Z3] +
(0.1658325372159041+0j) [Z1] +
(-0.19744293699755838+0j) [Z1 Z2 Z3] +
(0.17169788392286722+0j) [Z1 Z3] +
(-0.1974429369975584+0j) [Z2]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>Solution<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Map to QubitOperator using the BKT
hamiltonian_bk = of.bravyi_kitaev(hamiltonian_ferm_op)

# Convert to Scipy sparse matrix
hamiltonian_bk_sparse = of.get_sparse_operator(hamiltonian_bk)

# Compute ground state energy
eigs, _ = linalg.eigsh(hamiltonian_bk_sparse, k=1, which=&quot;SA&quot;)
ground_energy = eigs[0]

print(&quot;Ground_energy: {}&quot;.format(ground_energy))
print(&quot;BKT transformed Hamiltonian:&quot;)
print(hamiltonian_bk)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground_energy: -1.134147666677097
BKT transformed Hamiltonian:
(-0.16733398905695201+0j) [] +
(0.04615669588901533+0j) [X0 Z1 X2] +
(0.04615669588901533+0j) [X0 Z1 X2 Z3] +
(0.04615669588901533+0j) [Y0 Z1 Y2] +
(0.04615669588901533+0j) [Y0 Z1 Y2 Z3] +
(0.16251648748871642+0j) [Z0] +
(0.16251648748871636+0j) [Z0 Z1] +
(0.1633603430909739+0j) [Z0 Z1 Z2] +
(0.1633603430909739+0j) [Z0 Z1 Z2 Z3] +
(0.11720364720195856+0j) [Z0 Z2] +
(0.11720364720195856+0j) [Z0 Z2 Z3] +
(0.1658325372159041+0j) [Z1] +
(-0.19744293699755838+0j) [Z1 Z2 Z3] +
(0.17169788392286722+0j) [Z1 Z3] +
(-0.1974429369975584+0j) [Z2]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>Exercise<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The BCS mean-field d-wave model of superconductivity has the Hamiltonian</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
H = - t \sum_{\langle i,j \rangle} \sum_\sigma (a^\dagger_{i, \sigma} a_{j, \sigma} + a^\dagger_{j, \sigma} a_{i, \sigma}) - \sum_{\langle i,j \rangle} \Delta_{ij} (a^\dagger_{i, \uparrow} a^\dagger_{j, \downarrow} - a^\dagger_{i, \downarrow} a^\dagger_{j, \uparrow} + a_{j, \downarrow} a_{i, \uparrow} - a_{j, \uparrow} a_{i, \downarrow})
\]</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">mean_field_dwave</span></code> function to generate an instance of this model with dimensions 10x10.</p>
<ul class="simple">
<li><p>Convert the Hamiltonian to a <code class="docutils literal notranslate"><span class="pre">QubitOperator</span></code> with the JWT. What is the length of the longest Pauli string that appears?</p></li>
<li><p>Convert the Hamiltonian to a <code class="docutils literal notranslate"><span class="pre">QubitOperator</span></code> with the BKT. What is the length of the longest Pauli string that appears?</p></li>
<li><p>Convert the Hamiltonian to a <code class="docutils literal notranslate"><span class="pre">QuadraticHamiltonian</span></code>. Get its ground energy using the <code class="docutils literal notranslate"><span class="pre">ground_energy</span></code> method of <code class="docutils literal notranslate"><span class="pre">QuadraticHamiltonian</span></code>. What would happen if you tried to compute the ground energy by converting to a sparse matrix?</p></li>
</ul>
</section>
</section>
<section id="hamiltonian-simulation-with-trotter-formulas">
<h2>Hamiltonian simulation with Trotter formulas<a class="headerlink" href="#hamiltonian-simulation-with-trotter-formulas" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Goal: apply <span class="math notranslate nohighlight">\(\exp(-i H t)\)</span> where <span class="math notranslate nohighlight">\(H = \sum_j H_j\)</span></p></li>
<li><p>Use an approximation such as <span class="math notranslate nohighlight">\(\exp(-i H t) \approx (\prod_{j=1} \exp(-i H_j t/r))^r\)</span></p></li>
<li><p>Exposed via the <code class="docutils literal notranslate"><span class="pre">openfermion.simulate_trotter</span></code> function</p></li>
<li><p>Currently implemented algorithms are from <a class="reference external" href="https://arxiv.org/pdf/1706.00023.pdf">arXiv:1706.00023</a>, <a class="reference external" href="https://arxiv.org/pdf/1711.04789.pdf">arXiv:1711.04789</a>, and <a class="reference external" href="https://arxiv.org/pdf/1808.02625.pdf">arXiv:1808.02625</a>, and are based on the JWT</p></li>
<li><p>Currently supported Hamiltonian types: <code class="docutils literal notranslate"><span class="pre">DiagonalCoulombHamiltonian</span></code> and <code class="docutils literal notranslate"><span class="pre">InteractionOperator</span></code></p></li>
</ul>
<p>As a demonstration, we'll simulate time evolution under the hydrogen molecule Hamiltonian we generated earlier.</p>
<p>First, let's create a random initial state and apply the exact time evolution by matrix exponentiation:</p>
<div class="math notranslate nohighlight">
\[
\lvert \psi \rangle \mapsto \exp(-i H t) \lvert \psi \rangle
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Create a random initial state
n_qubits = of.count_qubits(hamiltonian)
initial_state = of.haar_random_vector(2**n_qubits, seed=7)

# Set evolution time
time = 1.0

# Apply exp(-i H t) to the state
exact_state = linalg.expm_multiply(-1j * hamiltonian_jw_sparse * time, initial_state)
</pre></div>
</div>
</div>
</div>
<p>Now, let's create a circuit to perform the evolution and compare the fidelity of the resulting state with the one from exact evolution. The fidelity can be increased by increasing the number of Trotter steps. Note that the Hamiltonian input to <code class="docutils literal notranslate"><span class="pre">openfermion.simulate_trotter</span></code> should be an <code class="docutils literal notranslate"><span class="pre">InteractionOperator</span></code>, not a <code class="docutils literal notranslate"><span class="pre">FermionOperator</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Initialize qubits
qubits = cirq.LineQubit.range(n_qubits)

# Create circuit
circuit = cirq.Circuit(
    of.simulate_trotter(
        qubits, hamiltonian, time, n_steps=10, order=0, algorithm=of.LOW_RANK
    )
)

# Apply the circuit to the initial state
result = circuit.final_state_vector(initial_state)

# Compute the fidelity with the final state from exact evolution
fidelity = abs(np.dot(exact_state, result.conj())) ** 2

print(fidelity)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9999820449924582
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>print(circuit.to_text_diagram(transpose=True))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0             1                  2                3
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.052π)    Rz(0.052π)         Rz(0.03π)        Rz(0.03π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.022           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.021
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.01π)    @──────────────────@^-0.021         Rz(-0.011π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.01π)         Rz(-0.011π)      │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.006
│             │                  │                │
@─────────────@^-0.006           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(0)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(0)              Rz(π)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^0                Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^0
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.03π)     Rz(0)              Rz(0)            Rz(0.052π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.03π)          Rz(0.052π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.022
│             │                  │                │
@─────────────@^-0.021           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.011π)   @──────────────────@^-0.021         Rz(-0.01π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.011π)        Rz(-0.01π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.006           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.006
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(π)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^0
│             │                  │                │
@─────────────@^0                ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.052π)    Rz(0)              Rz(0)            Rz(0.03π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.052π)         Rz(0.03π)        │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.022           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.021
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.01π)    @──────────────────@^-0.021         Rz(-0.011π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.01π)         Rz(-0.011π)      │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.006
│             │                  │                │
@─────────────@^-0.006           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(0)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(0)              Rz(π)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^0                Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^0
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.03π)     Rz(0)              Rz(0)            Rz(0.052π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.03π)          Rz(0.052π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.022
│             │                  │                │
@─────────────@^-0.021           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.011π)   @──────────────────@^-0.021         Rz(-0.01π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.011π)        Rz(-0.01π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.006           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.006
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(π)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^0
│             │                  │                │
@─────────────@^0                ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.052π)    Rz(0)              Rz(0)            Rz(0.03π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.052π)         Rz(0.03π)        │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.022           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.021
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.01π)    @──────────────────@^-0.021         Rz(-0.011π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.01π)         Rz(-0.011π)      │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.006
│             │                  │                │
@─────────────@^-0.006           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(0)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(0)              Rz(π)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^0                Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^0
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.03π)     Rz(0)              Rz(0)            Rz(0.052π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.03π)          Rz(0.052π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.022
│             │                  │                │
@─────────────@^-0.021           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.011π)   @──────────────────@^-0.021         Rz(-0.01π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.011π)        Rz(-0.01π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.006           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.006
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(π)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^0
│             │                  │                │
@─────────────@^0                ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.052π)    Rz(0)              Rz(0)            Rz(0.03π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.052π)         Rz(0.03π)        │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.022           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.021
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.01π)    @──────────────────@^-0.021         Rz(-0.011π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.01π)         Rz(-0.011π)      │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.006
│             │                  │                │
@─────────────@^-0.006           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(0)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(0)              Rz(π)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^0                Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^0
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.03π)     Rz(0)              Rz(0)            Rz(0.052π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.03π)          Rz(0.052π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.022
│             │                  │                │
@─────────────@^-0.021           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.011π)   @──────────────────@^-0.021         Rz(-0.01π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.011π)        Rz(-0.01π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.006           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.006
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(π)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^0
│             │                  │                │
@─────────────@^0                ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.052π)    Rz(0)              Rz(0)            Rz(0.03π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.052π)         Rz(0.03π)        │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.022           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.021
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.01π)    @──────────────────@^-0.021         Rz(-0.011π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.01π)         Rz(-0.011π)      │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.006
│             │                  │                │
@─────────────@^-0.006           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(0)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(0)              Rz(π)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-0.5 Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^0                Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^0
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
Rz(0.03π)     Rz(0)              Rz(0)            Rz(0.052π)
│             │                  │                │
Rz(0)         Rz(0)              Rz(0)            Rz(0)
│             │                  │                │
│             Rz(0.03π)          Rz(0.052π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-1
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^-1   Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^-0.022
│             │                  │                │
@─────────────@^-0.021           ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^-0.021         │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^-0.021           @────────────────@^-0.021
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.011π)   @──────────────────@^-0.021         Rz(-0.01π)
│             │                  │                │
Rz(π)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.011π)        Rz(-0.01π)       │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 Z^0
│             │                  │                │
@─────────────@^-0.006           Z^0              │
│             │                  │                │
×─────────────×                  @────────────────@^-0.006
│             │                  │                │
│             │                  ×────────────────×
│             │                  │                │
│             @──────────────────@^0.006          │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0.006            @────────────────@^0.006
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(-0.003π)   @──────────────────@^0.006          Rz(-0.003π)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(π)
│             │                  │                │
│             Rz(-0.003π)        Rz(-0.003π)      │
│             │                  │                │
│             Rz(π)              Rz(0)            │
│             │                  │                │
│             PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                PhISwap(0.25)────PhISwap(0.25)^-0.5
│             │                  │                │
PhISwap(0.25)─PhISwap(0.25)^0.5  Z^0              │
│             │                  │                │
Z^0           PhISwap(0.25)──────PhISwap(0.25)^-1 │
│             │                  │                │
│             Z^0                @────────────────@^0
│             │                  │                │
@─────────────@^0                ×────────────────×
│             │                  │                │
×─────────────×                  │                │
│             │                  │                │
│             @──────────────────@^0              │
│             │                  │                │
│             ×──────────────────×                │
│             │                  │                │
@─────────────@^0                @────────────────@^0
│             │                  │                │
×─────────────×                  ×────────────────×
│             │                  │                │
Rz(0)         @──────────────────@^0              Rz(0)
│             │                  │                │
Rz(0)         ×──────────────────×                Rz(0)
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
│             Rz(0)              Rz(0)            │
│             │                  │                │
</pre></div>
</div>
</div>
</div>
</section>
<section id="bogoliubov-transformation">
<h2>Bogoliubov transformation<a class="headerlink" href="#bogoliubov-transformation" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Single-particle orbital basis change</p></li>
<li><p>In the particle-conserving case, takes the form
$<span class="math notranslate nohighlight">\(
U a_p^\dagger U^\dagger = b_p^\dagger, \quad b_p^\dagger = \sum_{q} u_{pq} a_q^\dagger
\)</span><span class="math notranslate nohighlight">\(
and \)</span>u$ is unitary.</p></li>
<li><p>Can be used to diagonalize any quadratic Hamiltonian:
$<span class="math notranslate nohighlight">\(
\sum_{p, q} T_{pq} a_p^\dagger a_q \mapsto \sum_{j} \varepsilon_j b_j^\dagger b_j + \text{constant}
\)</span>$</p></li>
<li><p>Implementation from <a class="reference external" href="https://arxiv.org/pdf/1711.05395.pdf">arXiv:1711.05395</a>; uses linear depth and linear connectivity</p></li>
</ul>
<p>As an example, we'll prepare the ground state of a random particle-conserving quadratic Hamiltonian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>n_qubits = 5
quad_ham = of.random_quadratic_hamiltonian(
    n_qubits, conserves_particle_number=True, seed=7
)

print(of.get_fermion_operator(quad_ham))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.690525703800356 [] +
(0.5315776978980016+0j) [0^ 0] +
(-1.347208023348913+2.7004721387490935j) [0^ 1] +
(-0.28362365442898696-1.8784499457335426j) [0^ 2] +
(0.12594647819298657-1.3106154125325498j) [0^ 3] +
(-0.3880303291443195-1.1751249212322041j) [0^ 4] +
(-1.347208023348913-2.7004721387490935j) [1^ 0] +
(2.5012533818678193+0j) [1^ 1] +
(0.3391421007279024-3.8305756810505094j) [1^ 2] +
(-0.3509690502067961+0.090677856754656j) [1^ 3] +
(1.8575239595653907-1.4736314761076197j) [1^ 4] +
(-0.28362365442898696+1.8784499457335426j) [2^ 0] +
(0.3391421007279024+3.8305756810505094j) [2^ 1] +
(-0.019560786804260433+0j) [2^ 2] +
(-2.979765944360631+2.5490724453105917j) [2^ 3] +
(0.5091942820312417+0.344618218148502j) [2^ 4] +
(0.12594647819298657+1.3106154125325498j) [3^ 0] +
(-0.3509690502067961-0.090677856754656j) [3^ 1] +
(-2.979765944360631-2.5490724453105917j) [3^ 2] +
(3.767336752913784+0j) [3^ 3] +
(-1.2963431636902167-1.5288970105744286j) [3^ 4] +
(-0.3880303291443195+1.1751249212322041j) [4^ 0] +
(1.8575239595653907+1.4736314761076197j) [4^ 1] +
(0.5091942820312417-0.344618218148502j) [4^ 2] +
(-1.2963431636902167+1.5288970105744286j) [4^ 3] +
(-0.3445183403145406+0j) [4^ 4]
</pre></div>
</div>
</div>
</div>
<p>Now we construct a circuit which maps computational basis states to eigenstates of the Hamiltonian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>_, basis_change_matrix, _ = quad_ham.diagonalizing_bogoliubov_transform()

qubits = cirq.LineQubit.range(n_qubits)
circuit = cirq.Circuit(of.bogoliubov_transform(qubits, basis_change_matrix))

print(circuit.to_text_diagram(transpose=True))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0             1                   2                    3                     4
│             │                   │                    │                     │
Rz(0)         Rz(0)               Rz(π)                Rz(-π)                Rz(0)
│             │                   │                    │                     │
│             │                   │                    PhISwap(0.25)─────────PhISwap(0.25)^0.073
│             │                   │                    │                     │
│             │                   PhISwap(0.25)────────PhISwap(0.25)^(5/11)  Z^(-7/9)
│             │                   │                    │                     │
│             PhISwap(0.25)───────PhISwap(0.25)^0.814  Z^-0.508              │
│             │                   │                    │                     │
PhISwap(0.25)─PhISwap(0.25)^0.703 Z^-0.304             PhISwap(0.25)─────────PhISwap(0.25)^0.381
│             │                   │                    │                     │
│             Z^-0.767            PhISwap(0.25)────────PhISwap(0.25)^(13/16) Z^0.401
│             │                   │                    │                     │
│             PhISwap(0.25)───────PhISwap(0.25)^(7/11) Z^(-13/14)            │
│             │                   │                    │                     │
│             │                   Z^0.393              PhISwap(0.25)─────────PhISwap(0.25)^0.481
│             │                   │                    │                     │
│             │                   PhISwap(0.25)────────PhISwap(0.25)^0.422   Z^-0.738
│             │                   │                    │                     │
│             │                   │                    Z^-0.824              │
│             │                   │                    │                     │
│             │                   │                    PhISwap(0.25)─────────PhISwap(0.25)^0.506
│             │                   │                    │                     │
│             │                   │                    │                     Z^(5/7)
│             │                   │                    │                     │
</pre></div>
</div>
</div>
</div>
<p>In the rotated basis, the quadratic Hamiltonian takes the form
$<span class="math notranslate nohighlight">\(
H = \sum_j \varepsilon_j b_j^\dagger b_j + \text{constant}
\)</span><span class="math notranslate nohighlight">\(
We can get the \)</span>\varepsilon_j$ and the constant using the <code class="docutils literal notranslate"><span class="pre">orbital_energies</span></code> method of <code class="docutils literal notranslate"><span class="pre">QuadraticHamiltonian</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>orbital_energies, constant = quad_ham.orbital_energies()

print(orbital_energies)
print(constant)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-6.25377614 -1.2291963   0.71202361  5.0062515   8.20078604]
1.690525703800356
</pre></div>
</div>
</div>
</div>
<p>The ground state of the Hamiltonian is prepared by filling in the orbitals with negative energy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Apply the circuit with initial state having the first two modes occupied.
result = circuit.final_state_vector(initial_state=0b11000)

# Compute the expectation value of the final state with the Hamiltonian
quad_ham_sparse = of.get_sparse_operator(quad_ham)
print(of.expectation(quad_ham_sparse, result))

# Print out the ground state energy; it should match
print(quad_ham.ground_energy())
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-5.792446738060052+1.1102230246251565e-16j)
-5.792446738060049
</pre></div>
</div>
</div>
</div>
<p>Recall that the Jordan-Wigner transform of <span class="math notranslate nohighlight">\(b_j^\dagger b_j\)</span> is <span class="math notranslate nohighlight">\(\frac12(I-Z)\)</span>. Therefore, <span class="math notranslate nohighlight">\(\exp(-i \varepsilon_j b_j^\dagger b_j)\)</span> is equivalent to a single-qubit Z rotation under the JWT. Since the operators <span class="math notranslate nohighlight">\(b_j^\dagger b_j\)</span> commute, we have
$<span class="math notranslate nohighlight">\(
\exp(-i H t) = \exp(-i \sum_j \varepsilon_j b_j^\dagger b_j t)
= \prod_j \exp(-i \varepsilon_j b_j^\dagger b_j t)
\)</span>$
This gives a method for simulating time evolution under a quadratic Hamiltonian:</p>
<ul class="simple">
<li><p>Use a Bogoliubov transformation to change to the basis in which the Hamiltonian is diagonal (Note: this transformation might be the inverse of what you expect. In that case, use <code class="docutils literal notranslate"><span class="pre">cirq.inverse</span></code>)</p></li>
<li><p>Apply single-qubit Z-rotations with angles proportional to the orbital energies</p></li>
<li><p>Undo the basis change</p></li>
</ul>
<p>The code cell below creates a random initial state and applies time evolution by direct matrix exponentiation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Create a random initial state
initial_state = of.haar_random_vector(2**n_qubits)

# Set evolution time
time = 1.0

# Apply exp(-i H t) to the state
final_state = linalg.expm_multiply(-1j * quad_ham_sparse * time, initial_state)
</pre></div>
</div>
</div>
</div>
<section id="id6">
<h3>Exercise<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Fill in the code cell below to construct a circuit which applies <span class="math notranslate nohighlight">\(\exp(-i H t)\)</span> using the method described above</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Initialize qubits
qubits = cirq.LineQubit.range(n_qubits)

# Write code below to create the circuit
# You should define the `circuit` variable here
# ---------------------------------------------


# ---------------------------------------------

# Apply the circuit to the initial state
result = circuit.final_state_vector(initial_state)

# Compute the fidelity with the correct final state
fidelity = abs(np.dot(final_state, result.conj())) ** 2

# Print fidelity; it should be 1
print(fidelity)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.08926042490120051
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3>Solution<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Initialize qubits
qubits = cirq.LineQubit.range(n_qubits)

# Write code below to create the circuit
# You should define the `circuit` variable here
# ---------------------------------------------
def exponentiate_quad_ham(qubits, quad_ham):
    _, basis_change_matrix, _ = quad_ham.diagonalizing_bogoliubov_transform()
    orbital_energies, _ = quad_ham.orbital_energies()

    yield cirq.inverse(of.bogoliubov_transform(qubits, basis_change_matrix))
    for i in range(len(qubits)):
        yield cirq.rz(rads=-orbital_energies[i]).on(qubits[i])
    yield of.bogoliubov_transform(qubits, basis_change_matrix)


circuit = cirq.Circuit(exponentiate_quad_ham(qubits, quad_ham))
# ---------------------------------------------

# Apply the circuit to the initial state
result = circuit.final_state_vector(initial_state)

# Compute the fidelity with the correct final state
fidelity = abs(np.dot(final_state, result.conj())) ** 2

# Print fidelity; it should be 1
print(fidelity)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.999999999999994
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./myenv/openfermion/docs/tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目次
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Copyright 2020 The Cirq Developers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-simulation-of-electronic-structure">Quantum simulation of electronic structure</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fermionoperator-and-qubitoperator">FermionOperator and QubitOperator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#openfermion-fermionoperator"><code class="docutils literal notranslate"><span class="pre">openfermion.FermionOperator</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#openfermion-qubitoperator"><code class="docutils literal notranslate"><span class="pre">openfermion.QubitOperator</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-jordan-wigner-and-bravyi-kitaev-transforms">The Jordan-Wigner and Bravyi-Kitaev transforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Solution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-data-structures">Array data structures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interactionoperator">InteractionOperator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagonalcoulombhamiltonian">DiagonalCoulombHamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quadratichamiltonian">QuadraticHamiltonian</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-the-hamiltonian-for-a-molecule">Generating the Hamiltonian for a molecule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian-simulation-with-trotter-formulas">Hamiltonian simulation with Trotter formulas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bogoliubov-transformation">Bogoliubov transformation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  © Copyright 2025-present by 吉田 聡太 (Sota Yoshida). 本コンテンツは<a rel="license" href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0 ライセンス</a>の下に提供されています。 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>　ただし、資料中のコードセル部分は<a rel="license" href="https://opensource.org/licenses/MIT">MITライセンス</a>の下に提供されています。

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>