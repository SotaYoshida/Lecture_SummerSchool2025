
<!DOCTYPE html>


<html lang="ja" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Copyright 2020 The OpenFermion Developers &#8212; Julia言語による原子核構造計算入門</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../_static/documentation_options.js?v=1cf7f4d9"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../../_static/translations.js?v=91613774"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'myenv/openfermion/docs/tutorials/binary_code_transforms';</script>
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="検索" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ja"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">本文へスキップ</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>トップに戻る</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="バージョン警告"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../home.html">
  
  
  
  
  
  
    <p class="title logo__title">Julia言語による原子核構造計算入門</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">検索</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../home.html">
                    講義の狙いと資料の概要
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">pairing Hamiltonianと多体計算手法</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Hamiltonian.html">1. pairing Hamiltonian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/FullCI.html">2. Full-CI/厳密対角化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/HartreeFock.html">3. Hartree-Fock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/BCS.html">4. BCS (Bardeen-Cooper-Schrieffer)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/MBPT.html">5. Many-Body Perturbation Theory (MBPT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/CoupledCluster.html">6. Coupled Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/IMSRG.html">7. In-medium Similarity Renormalization Group (IM-SRG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/EC.html">8. Emulator/Surrogate model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">量子計算</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/QuantumComputing.html">9. Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Pairing_VQE_pennylane.html">10. Pairing HamiltonianのVQE計算 (Pennylane)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/qpe_pennylane.html">11. Pairing HamiltonianのQPE計算 (Pennylane)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Pairing_VQE_pytket.html">12. Pairing Hamiltonianの量子計算 (pytket)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SotaYoshida/Lecture_SummerSchool2025" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="ソースリポジトリ"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SotaYoshida/Lecture_SummerSchool2025/issues/new?title=Issue%20on%20page%20%2Fmyenv/openfermion/docs/tutorials/binary_code_transforms.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="問題を報告"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="このページをダウンロード">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/myenv/openfermion/docs/tutorials/binary_code_transforms.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="ソースファイルをダウンロード"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDFに印刷"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全画面モード"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="ライト"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="ダーク"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Copyright 2020 The OpenFermion Developers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目次 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Copyright 2020 The OpenFermion Developers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lowering-qubit-requirements-using-binary-codes">Lowering qubit requirements using binary codes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-binary-functions">Symbolic binary functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-codes">Binary codes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#appendage">Appendage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenation">Concatenation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operator-transform">Operator transform</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="copyright-2020-the-openfermion-developers">
<h1>Copyright 2020 The OpenFermion Developers<a class="headerlink" href="#copyright-2020-the-openfermion-developers" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># https://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lowering-qubit-requirements-using-binary-codes">
<h1>Lowering qubit requirements using binary codes<a class="headerlink" href="#lowering-qubit-requirements-using-binary-codes" title="Link to this heading">#</a></h1>
<table class="tfo-notebook-buttons" align="left">
  <td>
    <a target="_blank" href="https://quantumai.google/openfermion/tutorials/binary_code_transforms"><img src="https://quantumai.google/site-assets/images/buttons/quantumai_logo_1x.png" />View on QuantumAI</a>
  </td>
  <td>
    <a target="_blank" href="https://colab.research.google.com/github/quantumlib/OpenFermion/blob/master/docs/tutorials/binary_code_transforms.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/colab_logo_1x.png" />Run in Google Colab</a>
  </td>
  <td>
    <a target="_blank" href="https://github.com/quantumlib/OpenFermion/blob/master/docs/tutorials/binary_code_transforms.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/github_logo_1x.png" />View source on GitHub</a>
  </td>
  <td>
    <a href="https://storage.googleapis.com/tensorflow_docs/OpenFermion/docs/tutorials/binary_code_transforms.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/download_icon_1x.png" />Download notebook</a>
  </td>
</table><section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<p>Install the OpenFermion package:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">openfermion</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/quantumlib/OpenFermion.git@master#egg<span class="o">=</span>openfermion
</pre></div>
</div>
</div>
</div>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>Molecular Hamiltonians are known to have certain symmetries that are not taken into account by mappings like the Jordan-Wigner or Bravyi-Kitaev transform. The most notable of such symmetries is the conservation of the total number of particles in the system. Since those symmetries effectively reduce the degrees of freedom of the system, one is able to reduce the number of qubits required for simulation by utilizing binary codes (arXiv:1712.07067).</p>
<p>We can represent the symmetry-reduced Fermion basis by binary vectors of a set <span class="math notranslate nohighlight">\(\mathcal{V} \ni \boldsymbol{\nu}\)</span>, with <span class="math notranslate nohighlight">\( \boldsymbol{\nu} = (\nu_0, \, \nu_1, \dots, \, \nu_{N-1} ) \)</span>, where every component <span class="math notranslate nohighlight">\(\nu_i \in \lbrace 0, 1 \rbrace \)</span> and <span class="math notranslate nohighlight">\(N\)</span> is the total number of Fermion modes.  These binary vectors <span class="math notranslate nohighlight">\( \boldsymbol{\nu}\)</span> are related to the actual basis states by: $<span class="math notranslate nohighlight">\(
\left[\prod_{i=0}^{N-1} (a_i^{\dagger})^{\nu_i}  \right] \left|{\text{vac}}\right\rangle \, ,
\)</span><span class="math notranslate nohighlight">\( where \)</span> (a_i^\dagger)^{0}=1<span class="math notranslate nohighlight">\(. The qubit basis, on the other hand, can be characterized by length-\)</span>n<span class="math notranslate nohighlight">\( binary vectors \)</span>\boldsymbol{\omega}=(\omega_0, , \dots , , \omega_{n-1})<span class="math notranslate nohighlight">\(, that represent an \)</span>n<span class="math notranslate nohighlight">\(-qubit basis state by:
\)</span><span class="math notranslate nohighlight">\( \left|{\omega_0}\right\rangle  \otimes \left|\omega_1\right\rangle \otimes \dots \otimes  \left|{\omega_{n-1}}\right\rangle \, .  \)</span><span class="math notranslate nohighlight">\( 
Since \)</span>\mathcal{V}<span class="math notranslate nohighlight">\( is a mere subset of the \)</span>N<span class="math notranslate nohighlight">\(-fold binary space, but the set of the vectors \)</span>\boldsymbol{\omega}<span class="math notranslate nohighlight">\( spans the entire \)</span>n<span class="math notranslate nohighlight">\(-fold binary space we can assign every vector \)</span>\boldsymbol{\nu}<span class="math notranslate nohighlight">\( to a vector \)</span> \boldsymbol{\omega}<span class="math notranslate nohighlight">\(, such that \)</span>n&lt;N<span class="math notranslate nohighlight">\(. This reduces the amount of qubits required by \)</span>(N-n)<span class="math notranslate nohighlight">\(. The mapping can be done by a binary code, a classical object that consists of an encoder function \)</span>\boldsymbol{e}<span class="math notranslate nohighlight">\( and a decoder function \)</span>\boldsymbol{d}<span class="math notranslate nohighlight">\(. 
These functions relate the binary vectors \)</span>\boldsymbol{e}(\boldsymbol{\nu})=\boldsymbol{\omega}<span class="math notranslate nohighlight">\(, \)</span>\boldsymbol{d}(\boldsymbol{\omega})=\boldsymbol{\nu}<span class="math notranslate nohighlight">\(, such that \)</span>\boldsymbol{d}(\boldsymbol{e}(\boldsymbol{\nu}))=\boldsymbol{\nu}<span class="math notranslate nohighlight">\(.
In OpenFermion, we, at the moment, allow for non-linear decoders \)</span>\boldsymbol{d}<span class="math notranslate nohighlight">\( and linear encoders \)</span>\boldsymbol{e}(\boldsymbol{\nu})=A \boldsymbol{\nu}<span class="math notranslate nohighlight">\(, where the matrix multiplication with the \)</span>(n\times N)<span class="math notranslate nohighlight">\(-binary matrix \)</span>A<span class="math notranslate nohighlight">\( is \)</span>(\text{mod 2})$ in every component.</p>
</section>
<section id="symbolic-binary-functions">
<h2>Symbolic binary functions<a class="headerlink" href="#symbolic-binary-functions" title="Link to this heading">#</a></h2>
<p>The non-linear binary functions for the components of the decoder are here modeled by the <span class="math notranslate nohighlight">\(\text{BinaryPolynomial}\)</span> class in openfermion.ops.
For initialization we can conveniently use strings ('w0 w1 + w1 +1' for the binary function <span class="math notranslate nohighlight">\(\boldsymbol{\omega} \to \omega_0 \omega_1 + \omega_1 + 1 \;\text{mod 2}\)</span>), the native data structure or symbolic addition and multiplication.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.ops</span> <span class="kn">import</span> <span class="n">BinaryPolynomial</span>

<span class="n">binary_1</span> <span class="o">=</span> <span class="n">BinaryPolynomial</span><span class="p">(</span><span class="s1">&#39;w0 w1 + w1 + 1&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;These three expressions are equivalent: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">binary_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">BinaryPolynomial</span><span class="p">(</span><span class="s1">&#39;w0&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">BinaryPolynomial</span><span class="p">(</span><span class="s1">&#39;w1 + 1&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">BinaryPolynomial</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">BinaryPolynomial</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">),</span> <span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="p">)]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The native data type structure can be seen here:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">binary_1</span><span class="o">.</span><span class="n">terms</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;We can always evaluate the expression for instance by the vector (w0, w1, w2) = (1, 0, 0):&#39;</span><span class="p">,</span>
      <span class="n">binary_1</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="binary-codes">
<h2>Binary codes<a class="headerlink" href="#binary-codes" title="Link to this heading">#</a></h2>
<p>The <span class="math notranslate nohighlight">\(\text{BinaryCode}\)</span> class bundles a decoder - a list of decoder components, which are instances of <span class="math notranslate nohighlight">\(\text{BinaryPolynomial}\)</span> - and an encoder - the matrix <span class="math notranslate nohighlight">\(A\)</span> as sparse numpy array -  as a binary code. The constructor however admits (dense) numpy arrays, nested lists or tuples as input for <span class="math notranslate nohighlight">\(A\)</span>, and arrays, lists or tuples of <span class="math notranslate nohighlight">\(\text{BinaryPolynomial}\)</span> objects - or valid inputs for <span class="math notranslate nohighlight">\(\text{BinaryPolynomial}\)</span> constructors - as input for <span class="math notranslate nohighlight">\(\boldsymbol{d}\)</span>. An instance of the <span class="math notranslate nohighlight">\(\text{BinaryCode}\)</span> class knows about the number of qubits and the number of modes in the mapping.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.ops</span> <span class="kn">import</span> <span class="n">BinaryCode</span>

<span class="n">code_1</span> <span class="o">=</span> <span class="n">BinaryCode</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;w0&#39;</span><span class="p">,</span> <span class="s1">&#39;w1&#39;</span><span class="p">,</span> <span class="s1">&#39;w0 + w1 + 1&#39;</span> <span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">code_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of qubits: &#39;</span><span class="p">,</span> <span class="n">code_1</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">,</span> <span class="s1">&#39;  number of Fermion modes: &#39;</span><span class="p">,</span> <span class="n">code_1</span><span class="o">.</span><span class="n">n_modes</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;encoding matrix: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">code_1</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;decoder: &#39;</span><span class="p">,</span> <span class="n">code_1</span><span class="o">.</span><span class="n">decoder</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The code used in the example above, is in fact the (odd) Checksum code, and is implemented already - along with a few other examples from arxiv:1712.07067. In addition to the <span class="math notranslate nohighlight">\(\text{checksum_code}\)</span> the functions <span class="math notranslate nohighlight">\(\text{weight_one_segment_code}\)</span>, <span class="math notranslate nohighlight">\(\text{weight_two_segment_code}\)</span>, that output a subcode each, as well as <span class="math notranslate nohighlight">\(\text{weight_one_binary_addressing_code}\)</span> can be found under openfermion.transforms._code_transform_functions.</p>
<p>There are two other ways to construct new codes from the ones given - both of them can be done conveniently with symbolic operations between two code objects <span class="math notranslate nohighlight">\((\boldsymbol{e}, \boldsymbol{d})\)</span> and <span class="math notranslate nohighlight">\((\boldsymbol{e^\prime}, \boldsymbol{d^\prime})\)</span> to yield a new code <span class="math notranslate nohighlight">\((\boldsymbol{e^{\prime\prime}}, \boldsymbol{d^{\prime\prime}})\)</span>:</p>
<section id="appendage">
<h3>Appendage<a class="headerlink" href="#appendage" title="Link to this heading">#</a></h3>
<p>Input and output vectors of two codes are appended to each other such that:
$<span class="math notranslate nohighlight">\( e^{\prime\prime}(\boldsymbol{\nu} \oplus \boldsymbol{\nu^{\prime} })=\boldsymbol{e}(\boldsymbol{\nu}) \oplus \boldsymbol{e^\prime}(\boldsymbol{\nu^\prime})\, ,  \qquad d^{\prime\prime}(\boldsymbol{\omega} \oplus \boldsymbol{\omega^{\prime} })=\boldsymbol{d}(\boldsymbol{\omega}) \oplus \boldsymbol{d^\prime}(\boldsymbol{\omega^\prime}) \, . \)</span><span class="math notranslate nohighlight">\(
This is implemented with symbolic addition of two \)</span>\text{BinaryCode}<span class="math notranslate nohighlight">\( objects (using + or += ) or, for appending several instances of the same code at once, multiplication of the \)</span>\text{BinaryCode}$ with an integer. Appending codes is useful when we want to obtain a segment code, or a segmented transform.</p>
</section>
<section id="concatenation">
<h3>Concatenation<a class="headerlink" href="#concatenation" title="Link to this heading">#</a></h3>
<p>Two codes can (if the corresponding vectors match in size) be applied consecutively, in the sense that the output of the encoder of the first code is input to the encoder of the second code. This defines an entirely new encoder, and the corresponding decoder is defined to undo this operation.
$<span class="math notranslate nohighlight">\( \boldsymbol{e^{\prime\prime}}(\boldsymbol{\nu^{\prime\prime}})=\boldsymbol{e^\prime}\left(\boldsymbol{e}(\boldsymbol{\nu^{\prime\prime}}) \right) \, , \qquad \boldsymbol{d^{\prime\prime}}(\boldsymbol{\omega^{\prime\prime}})=\boldsymbol{d}\left(\boldsymbol{d^\prime}(\boldsymbol{\omega^{\prime\prime}}) \right)
\)</span><span class="math notranslate nohighlight">\(
This is done by symbolic multiplication of two \)</span>\text{BinaryCode}$ instances (with * or *=  ). One can concatenate the codes with each other such that additional qubits can be saved (e.g. checksum code * segment code ), or to modify the resulting gates after transform (e.g. checksum code * Bravyi-Kitaev code).</p>
<p>A broad palette of codes is provided to help construct codes symbolically.
The <span class="math notranslate nohighlight">\(\text{jordan_wigner_code}\)</span> can be appended to every code to fill the number of modes, concatenating the <span class="math notranslate nohighlight">\(\text{bravyi_kitaev_code}\)</span> or <span class="math notranslate nohighlight">\(\text{parity_code}\)</span> will modify the appearance of gates after the transform. The <span class="math notranslate nohighlight">\(\text{interleaved_code}\)</span> is useful to concatenate appended codes with if in Hamiltonians, Fermion operators are ordered by spin indexing even-odd (up-down-up-down-up ...) . This particular instance is used in the demonstration below.</p>
<p>Before we turn to describe the transformation, a word of warning has to be spoken here. Controlled gates that occur in the Hamiltonian by using non-linear codes are decomposed into Pauli strings, e.g. <span class="math notranslate nohighlight">\(\text{CPHASE}(1,2)=\frac{1}{2}(1+Z_1+Z_2-Z_1Z_2)\)</span>. In that way the amount of terms in a Hamiltonian might rise exponentially, if one chooses to use strongly non-linear codes.</p>
</section>
</section>
<section id="operator-transform">
<h2>Operator transform<a class="headerlink" href="#operator-transform" title="Link to this heading">#</a></h2>
<p>The actual transform of Fermion operators into qubit operators is done with the routine <span class="math notranslate nohighlight">\(\text{binary_code_transform}\)</span>, that takes a Hamiltonian and a suitable code as inputs, outputting a qubit Hamiltonian.<br />
Let us consider the case of a molecule with 4 modes where, due to the absence of magnetic interactions, the set of valid modes is only $<span class="math notranslate nohighlight">\( \mathcal{V}=\lbrace (1,\, 1,\, 0,\, 0 ),\,(1,\, 0,\, 0,\, 1 ),\,(0,\, 1,\, 1,\, 0 ),\,(0,\, 0,\, 1,\, 1 )\rbrace \, .\)</span>$
One can either use an (even weight) checksum code to save a single qubit, or use and (odd weight) checksum code on spin-up and -down modes each to save two qubits. Since the ordering is even-odd, however, this requires to concatenate the with the interleaved code, which switches the spin indexing of the qubits from even-odd ordering to up-then-down. Instead of using the interleaved code, we can also use the reorder function to apply up-then-down ordering on the hamiltonian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">openfermion.chem</span> <span class="kn">import</span> <span class="n">MolecularData</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">binary_code_transform</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">get_fermion_operator</span>
<span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">eigenspectrum</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">normal_ordered</span><span class="p">,</span> <span class="n">reorder</span>
<span class="kn">from</span> <span class="nn">openfermion.utils</span> <span class="kn">import</span> <span class="n">up_then_down</span>

<span class="k">def</span> <span class="nf">LiH_hamiltonian</span><span class="p">():</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.45</span><span class="p">))]</span>
    <span class="n">molecule</span> <span class="o">=</span> <span class="n">MolecularData</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="n">description</span><span class="o">=</span><span class="s2">&quot;1.45&quot;</span><span class="p">)</span>
    <span class="n">molecule</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="n">molecular_hamiltonian</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_molecular_hamiltonian</span><span class="p">(</span><span class="n">occupied_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">active_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">normal_ordered</span><span class="p">(</span><span class="n">get_fermion_operator</span><span class="p">(</span><span class="n">molecular_hamiltonian</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">hamiltonian</span>

<span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">LiH_hamiltonian</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fermionic Hamiltonian&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">hamiltonian</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The eigenspectrum&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenspectrum</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">jw</span> <span class="o">=</span> <span class="n">binary_code_transform</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">jordan_wigner_code</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Jordan-Wigner transformed Hamiltonian&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the eigenspectrum of the transformed hamiltonian&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenspectrum</span><span class="p">(</span><span class="n">jw</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">cksm_save_one</span> <span class="o">=</span> <span class="n">binary_code_transform</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">checksum_code</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Even-weight checksum code&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cksm_save_one</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the eigenspectrum of the transformed hamiltonian&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenspectrum</span><span class="p">(</span><span class="n">cksm_save_one</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">up_down_save_two</span> <span class="o">=</span> <span class="n">binary_code_transform</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">interleaved_code</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">checksum_code</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Double odd-weight checksum codes&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">up_down_save_two</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the eigenspectrum of the transformed hamiltonian&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenspectrum</span><span class="p">(</span><span class="n">up_down_save_two</span> <span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Instead of interleaving, we can apply up-then-down ordering using the reorder function:&#39;</span><span class="p">)</span>
<span class="n">up_down_save_two</span> <span class="o">=</span> <span class="n">binary_code_transform</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span><span class="n">up_then_down</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">checksum_code</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">up_down_save_two</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the eigenspectrum of the transformed hamiltonian&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenspectrum</span><span class="p">(</span><span class="n">up_down_save_two</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./myenv/openfermion/docs/tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目次
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Copyright 2020 The OpenFermion Developers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lowering-qubit-requirements-using-binary-codes">Lowering qubit requirements using binary codes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-binary-functions">Symbolic binary functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-codes">Binary codes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#appendage">Appendage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenation">Concatenation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operator-transform">Operator transform</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  © Copyright 2025-present by 吉田 聡太 (Sota Yoshida). 本コンテンツは<a rel="license" href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0 ライセンス</a>の下に提供されています。 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>　ただし、資料中のコードセル部分は<a rel="license" href="https://opensource.org/licenses/MIT">MITライセンス</a>の下に提供されています。

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>