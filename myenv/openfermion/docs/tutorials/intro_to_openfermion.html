
<!DOCTYPE html>


<html lang="ja" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Copyright 2020 The OpenFermion Developers &#8212; Julia言語による原子核構造計算入門</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../_static/documentation_options.js?v=1cf7f4d9"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../../_static/translations.js?v=91613774"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'myenv/openfermion/docs/tutorials/intro_to_openfermion';</script>
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="検索" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ja"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">本文へスキップ</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>トップに戻る</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="バージョン警告"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../home.html">
  
  
  
  
  
  
    <p class="title logo__title">Julia言語による原子核構造計算入門</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">検索</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../home.html">
                    講義の狙いと資料の概要
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">pairing Hamiltonianと多体計算手法</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Hamiltonian.html">1. pairing Hamiltonian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/FullCI.html">2. Full-CI/厳密対角化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/HartreeFock.html">3. Hartree-Fock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/BCS.html">4. BCS (Bardeen-Cooper-Schrieffer)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/MBPT.html">5. Many-Body Perturbation Theory (MBPT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/CoupledCluster.html">6. Coupled Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/IMSRG.html">7. In-medium Similarity Renormalization Group (IM-SRG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/EC.html">8. Emulator/Surrogate model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">量子計算</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/QuantumComputing.html">9. Quantum Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Pairing_VQE_pennylane.html">10. Pairing HamiltonianのVQE計算 (Pennylane)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/qpe_pennylane.html">11. Pairing HamiltonianのQPE計算 (Pennylane)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Pairing_VQE_pytket.html">12. Pairing Hamiltonianの量子計算 (pytket)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SotaYoshida/Lecture_SummerSchool2025" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="ソースリポジトリ"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SotaYoshida/Lecture_SummerSchool2025/issues/new?title=Issue%20on%20page%20%2Fmyenv/openfermion/docs/tutorials/intro_to_openfermion.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="問題を報告"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="このページをダウンロード">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/myenv/openfermion/docs/tutorials/intro_to_openfermion.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="ソースファイルをダウンロード"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDFに印刷"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全画面モード"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="ライト"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="ダーク"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Copyright 2020 The OpenFermion Developers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目次 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Copyright 2020 The OpenFermion Developers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-openfermion">Introduction to OpenFermion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initializing-the-fermionoperator-data-structure">Initializing the FermionOperator data structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulating-the-fermionoperator-data-structure">Manipulating the FermionOperator data structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-qubitoperator-data-structure">The QubitOperator data structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jordan-wigner-and-bravyi-kitaev">Jordan-Wigner and Bravyi-Kitaev</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sparse-matrices-and-the-hubbard-model">Sparse matrices and the Hubbard model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonians-in-the-plane-wave-basis">Hamiltonians in the plane wave basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basics-of-moleculardata-class">Basics of MolecularData class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactionoperator-and-interactionrdm-for-efficient-numerical-representations">InteractionOperator and InteractionRDM for efficient numerical representations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quadratic-hamiltonians-and-slater-determinants">Quadratic Hamiltonians and Slater determinants</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="copyright-2020-the-openfermion-developers">
<h1>Copyright 2020 The OpenFermion Developers<a class="headerlink" href="#copyright-2020-the-openfermion-developers" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># https://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction-to-openfermion">
<h1>Introduction to OpenFermion<a class="headerlink" href="#introduction-to-openfermion" title="Link to this heading">#</a></h1>
<table class="tfo-notebook-buttons" align="left">
  <td>
    <a target="_blank" href="https://quantumai.google/openfermion/tutorials/intro_to_openfermion"><img src="https://quantumai.google/site-assets/images/buttons/quantumai_logo_1x.png" />View on QuantumAI</a>
  </td>
  <td>
    <a target="_blank" href="https://colab.research.google.com/github/quantumlib/OpenFermion/blob/master/docs/tutorials/intro_to_openfermion.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/colab_logo_1x.png" />Run in Google Colab</a>
  </td>
  <td>
    <a target="_blank" href="https://github.com/quantumlib/OpenFermion/blob/master/docs/tutorials/intro_to_openfermion.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/github_logo_1x.png" />View source on GitHub</a>
  </td>
  <td>
    <a href="https://storage.googleapis.com/tensorflow_docs/OpenFermion/docs/tutorials/intro_to_openfermion.ipynb"><img src="https://quantumai.google/site-assets/images/buttons/download_icon_1x.png" />Download notebook</a>
  </td>
</table><p>Note: The examples below must be run sequentially within a section.</p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<p>Install the OpenFermion package:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">openfermion</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/quantumlib/OpenFermion.git@master#egg<span class="o">=</span>openfermion
</pre></div>
</div>
</div>
</div>
</section>
<section id="initializing-the-fermionoperator-data-structure">
<h2>Initializing the FermionOperator data structure<a class="headerlink" href="#initializing-the-fermionoperator-data-structure" title="Link to this heading">#</a></h2>
<p>Fermionic systems are often treated in second quantization where arbitrary operators can be expressed using the fermionic creation and annihilation operators, <span class="math notranslate nohighlight">\(a^\dagger_k\)</span> and <span class="math notranslate nohighlight">\(a_k\)</span>.  The fermionic ladder operators play a similar role to their qubit ladder operator counterparts, <span class="math notranslate nohighlight">\(\sigma^+_k\)</span> and <span class="math notranslate nohighlight">\(\sigma^-_k\)</span> but are distinguished by the canonical fermionic anticommutation relations, <span class="math notranslate nohighlight">\(\{a^\dagger_i, a^\dagger_j\} = \{a_i, a_j\} = 0\)</span> and <span class="math notranslate nohighlight">\(\{a_i, a_j^\dagger\} = \delta_{ij}\)</span>. Any weighted sums of products of these operators are represented with the FermionOperator data structure in OpenFermion. The following are examples of valid FermionOperators:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
&amp; a_1 \nonumber \\
&amp; 1.7 a^\dagger_3 \nonumber \\
&amp;-1.7 \, a^\dagger_3 a_1 \nonumber \\
&amp;(1 + 2i) \, a^\dagger_4 a^\dagger_3 a_9 a_1 \nonumber \\
&amp;(1 + 2i) \, a^\dagger_4 a^\dagger_3 a_9 a_1 - 1.7 \, a^\dagger_3 a_1 \nonumber
\end{align}
\end{split}\]</div>
<p>The FermionOperator class is contained in <span class="math notranslate nohighlight">\(\textrm{ops/_fermion_operator.py}\)</span>. In order to support fast addition of FermionOperator instances, the class is implemented as hash table (python dictionary). The keys of the dictionary encode the strings of ladder operators and values of the dictionary store the coefficients. The strings of ladder operators are encoded as a tuple of 2-tuples which we refer to as the &quot;terms tuple&quot;. Each ladder operator is represented by a 2-tuple. The first element of the 2-tuple is an int indicating the tensor factor on which the ladder operator acts. The second element of the 2-tuple is Boole: 1 represents raising and 0 represents lowering. For instance, <span class="math notranslate nohighlight">\(a^\dagger_8\)</span> is represented in a 2-tuple as <span class="math notranslate nohighlight">\((8, 1)\)</span>. Note that indices start at 0 and the identity operator is an empty list. Below we give some examples of operators and their terms tuple:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
I &amp; \mapsto () \nonumber \\
a_1 &amp; \mapsto ((1, 0),) \nonumber \\
a^\dagger_3 &amp; \mapsto ((3, 1),) \nonumber \\
a^\dagger_3 a_1 &amp; \mapsto ((3, 1), (1, 0)) \nonumber \\
a^\dagger_4 a^\dagger_3 a_9 a_1 &amp; \mapsto ((4, 1), (3, 1), (9, 0), (1, 0)) \nonumber
\end{align}
\end{split}\]</div>
<p>Note that when initializing a single ladder operator one should be careful to add the comma after the inner pair. This is because in python ((1, 2)) = (1, 2) whereas ((1, 2),) = ((1, 2),). The &quot;terms tuple&quot; is usually convenient when one wishes to initialize a term as part of a coded routine. However, the terms tuple is not particularly intuitive. Accordingly, OpenFermion also supports another user-friendly, string notation below. This representation is rendered when calling &quot;print&quot; on a FermionOperator.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
I &amp; \mapsto \textrm{&quot;&quot;} \nonumber \\
a_1 &amp; \mapsto \textrm{&quot;1&quot;} \nonumber \\
a^\dagger_3 &amp; \mapsto \textrm{&quot;3^&quot;} \nonumber \\
a^\dagger_3 a_1 &amp; \mapsto \textrm{&quot;3^}\;\textrm{1&quot;} \nonumber \\
a^\dagger_4 a^\dagger_3 a_9 a_1 &amp; \mapsto \textrm{&quot;4^}\;\textrm{3^}\;\textrm{9}\;\textrm{1&quot;} \nonumber
\end{align}
\end{split}\]</div>
<p>Let's initialize our first term! We do it two different ways below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.ops</span> <span class="kn">import</span> <span class="n">FermionOperator</span>

<span class="n">my_term</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_term</span><span class="p">)</span>

<span class="n">my_term</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;3^ 1&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_term</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The preferred way to specify the coefficient in openfermion is to provide an optional coefficient argument. If not provided, the coefficient defaults to 1. In the code below, the first method is preferred. The multiplication in the second method actually creates a copy of the term, which introduces some additional cost. All inplace operands (such as +=) modify classes whereas binary operands such as + create copies. Important caveats are that the empty tuple FermionOperator(()) and the empty string FermionOperator('') initializes identity. The empty initializer FermionOperator() initializes the zero operator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_way_to_initialize</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;3^ 1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">good_way_to_initialize</span><span class="p">)</span>

<span class="n">bad_way_to_initialize</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.7</span> <span class="o">*</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;3^ 1&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bad_way_to_initialize</span><span class="p">)</span>

<span class="n">identity</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">identity</span><span class="p">)</span>

<span class="n">zero_operator</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zero_operator</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that FermionOperator has only one attribute: .terms. This attribute is the dictionary which stores the term tuples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_operator</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;4^ 1^ 3 9&#39;</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">2.</span><span class="n">j</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_operator</span><span class="o">.</span><span class="n">terms</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="manipulating-the-fermionoperator-data-structure">
<h2>Manipulating the FermionOperator data structure<a class="headerlink" href="#manipulating-the-fermionoperator-data-structure" title="Link to this heading">#</a></h2>
<p>So far we have explained how to initialize a single FermionOperator such as <span class="math notranslate nohighlight">\(-1.7 \, a^\dagger_3 a_1\)</span>. However, in general we will want to represent sums of these operators such as <span class="math notranslate nohighlight">\((1 + 2i) \, a^\dagger_4 a^\dagger_3 a_9 a_1 - 1.7 \, a^\dagger_3 a_1\)</span>. To do this, just add together two FermionOperators! We demonstrate below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.ops</span> <span class="kn">import</span> <span class="n">FermionOperator</span>

<span class="n">term_1</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;4^ 3^ 9 1&#39;</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">2.</span><span class="n">j</span><span class="p">)</span>
<span class="n">term_2</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;3^ 1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">)</span>
<span class="n">my_operator</span> <span class="o">=</span> <span class="n">term_1</span> <span class="o">+</span> <span class="n">term_2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_operator</span><span class="p">)</span>

<span class="n">my_operator</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;4^ 3^ 9 1&#39;</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">2.</span><span class="n">j</span><span class="p">)</span>
<span class="n">term_2</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;3^ 1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">)</span>
<span class="n">my_operator</span> <span class="o">+=</span> <span class="n">term_2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_operator</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The print function prints each term in the operator on a different line. Note that the line my_operator = term_1 + term_2 creates a new object, which involves a copy of term_1 and term_2. The second block of code uses the inplace method +=, which is more efficient. This is especially important when trying to construct a very large FermionOperator. FermionOperators also support a wide range of builtins including, str(), repr(), ==, !=, *=, *, /, /=, +, +=, -, -=, - and **. Note that since FermionOperators involve floats, == and != check for (in)equality up to numerical precision. We demonstrate some of these methods below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">term_1</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;4^ 3^ 9 1&#39;</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">2.</span><span class="n">j</span><span class="p">)</span>
<span class="n">term_2</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;3^ 1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">)</span>

<span class="n">my_operator</span> <span class="o">=</span> <span class="n">term_1</span> <span class="o">-</span> <span class="mf">33.</span> <span class="o">*</span> <span class="n">term_2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_operator</span><span class="p">)</span>

<span class="n">my_operator</span> <span class="o">*=</span> <span class="mf">3.17</span> <span class="o">*</span> <span class="p">(</span><span class="n">term_2</span> <span class="o">+</span> <span class="n">term_1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_operator</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">term_2</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">term_1</span> <span class="o">==</span> <span class="mf">2.</span><span class="o">*</span><span class="n">term_1</span> <span class="o">-</span> <span class="n">term_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">term_1</span> <span class="o">==</span> <span class="n">my_operator</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Additionally, there are a variety of methods that act on the FermionOperator data structure. We demonstrate a small subset of those methods here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.utils</span> <span class="kn">import</span> <span class="n">commutator</span><span class="p">,</span> <span class="n">count_qubits</span><span class="p">,</span> <span class="n">hermitian_conjugated</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">normal_ordered</span>

<span class="c1"># Get the Hermitian conjugate of a FermionOperator, count its qubit, check if it is normal-ordered.</span>
<span class="n">term_1</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;4^ 3 3^&#39;</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">+</span> <span class="mf">2.</span><span class="n">j</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hermitian_conjugated</span><span class="p">(</span><span class="n">term_1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">term_1</span><span class="o">.</span><span class="n">is_normal_ordered</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">count_qubits</span><span class="p">(</span><span class="n">term_1</span><span class="p">))</span>

<span class="c1"># Normal order the term.</span>
<span class="n">term_2</span> <span class="o">=</span> <span class="n">normal_ordered</span><span class="p">(</span><span class="n">term_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">term_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">term_2</span><span class="o">.</span><span class="n">is_normal_ordered</span><span class="p">())</span>

<span class="c1"># Compute a commutator of the terms.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">commutator</span><span class="p">(</span><span class="n">term_1</span><span class="p">,</span> <span class="n">term_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-qubitoperator-data-structure">
<h2>The QubitOperator data structure<a class="headerlink" href="#the-qubitoperator-data-structure" title="Link to this heading">#</a></h2>
<p>The QubitOperator data structure is another essential part of openfermion. As the name suggests, QubitOperator is used to store qubit operators in almost exactly the same way that FermionOperator is used to store fermion operators. For instance <span class="math notranslate nohighlight">\(X_0 Z_3 Y_4\)</span> is a QubitOperator. The internal representation of this as a terms tuple would be <span class="math notranslate nohighlight">\(((0, \textrm{&quot;X&quot;}), (3, \textrm{&quot;Z&quot;}), (4, \textrm{&quot;Y&quot;}))\)</span>. Note that one important difference between QubitOperator and FermionOperator is that the terms in QubitOperator are always sorted in order of tensor factor. In some cases, this enables faster manipulation. We initialize some QubitOperators below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.ops</span> <span class="kn">import</span> <span class="n">QubitOperator</span>

<span class="n">my_first_qubit_operator</span> <span class="o">=</span> <span class="n">QubitOperator</span><span class="p">(</span><span class="s1">&#39;X1 Y2 Z3&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_first_qubit_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_first_qubit_operator</span><span class="o">.</span><span class="n">terms</span><span class="p">)</span>

<span class="n">operator_2</span> <span class="o">=</span> <span class="n">QubitOperator</span><span class="p">(</span><span class="s1">&#39;X3 Z4&#39;</span><span class="p">,</span> <span class="mf">3.17</span><span class="p">)</span>
<span class="n">operator_2</span> <span class="o">-=</span> <span class="mf">77.</span> <span class="o">*</span> <span class="n">my_first_qubit_operator</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">operator_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="jordan-wigner-and-bravyi-kitaev">
<h2>Jordan-Wigner and Bravyi-Kitaev<a class="headerlink" href="#jordan-wigner-and-bravyi-kitaev" title="Link to this heading">#</a></h2>
<p>openfermion provides functions for mapping FermionOperators to QubitOperators.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.ops</span> <span class="kn">import</span> <span class="n">FermionOperator</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">jordan_wigner</span><span class="p">,</span> <span class="n">bravyi_kitaev</span>
<span class="kn">from</span> <span class="nn">openfermion.utils</span> <span class="kn">import</span> <span class="n">hermitian_conjugated</span>
<span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">eigenspectrum</span>

<span class="c1"># Initialize an operator.</span>
<span class="n">fermion_operator</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">(</span><span class="s1">&#39;2^ 0&#39;</span><span class="p">,</span> <span class="mf">3.17</span><span class="p">)</span>
<span class="n">fermion_operator</span> <span class="o">+=</span> <span class="n">hermitian_conjugated</span><span class="p">(</span><span class="n">fermion_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fermion_operator</span><span class="p">)</span>

<span class="c1"># Transform to qubits under the Jordan-Wigner transformation and print its spectrum.</span>
<span class="n">jw_operator</span> <span class="o">=</span> <span class="n">jordan_wigner</span><span class="p">(</span><span class="n">fermion_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jw_operator</span><span class="p">)</span>
<span class="n">jw_spectrum</span> <span class="o">=</span> <span class="n">eigenspectrum</span><span class="p">(</span><span class="n">jw_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jw_spectrum</span><span class="p">)</span>

<span class="c1"># Transform to qubits under the Bravyi-Kitaev transformation and print its spectrum.</span>
<span class="n">bk_operator</span> <span class="o">=</span> <span class="n">bravyi_kitaev</span><span class="p">(</span><span class="n">fermion_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bk_operator</span><span class="p">)</span>
<span class="n">bk_spectrum</span> <span class="o">=</span> <span class="n">eigenspectrum</span><span class="p">(</span><span class="n">bk_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bk_spectrum</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We see that despite the different representation, these operators are iso-spectral. We can also apply the Jordan-Wigner transform in reverse to map arbitrary QubitOperators to FermionOperators. Note that we also demonstrate the .compress() method (a method on both FermionOperators and QubitOperators) which removes zero entries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">reverse_jordan_wigner</span>

<span class="c1"># Initialize QubitOperator.</span>
<span class="n">my_operator</span> <span class="o">=</span> <span class="n">QubitOperator</span><span class="p">(</span><span class="s1">&#39;X0 Y1 Z2&#39;</span><span class="p">,</span> <span class="mf">88.</span><span class="p">)</span>
<span class="n">my_operator</span> <span class="o">+=</span> <span class="n">QubitOperator</span><span class="p">(</span><span class="s1">&#39;Z1 Z4&#39;</span><span class="p">,</span> <span class="mf">3.17</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_operator</span><span class="p">)</span>

<span class="c1"># Map QubitOperator to a FermionOperator.</span>
<span class="n">mapped_operator</span> <span class="o">=</span> <span class="n">reverse_jordan_wigner</span><span class="p">(</span><span class="n">my_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mapped_operator</span><span class="p">)</span>

<span class="c1"># Map the operator back to qubits and make sure it is the same.</span>
<span class="n">back_to_normal</span> <span class="o">=</span> <span class="n">jordan_wigner</span><span class="p">(</span><span class="n">mapped_operator</span><span class="p">)</span>
<span class="n">back_to_normal</span><span class="o">.</span><span class="n">compress</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">back_to_normal</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sparse-matrices-and-the-hubbard-model">
<h2>Sparse matrices and the Hubbard model<a class="headerlink" href="#sparse-matrices-and-the-hubbard-model" title="Link to this heading">#</a></h2>
<p>Often, one would like to obtain a sparse matrix representation of an operator which can be analyzed numerically. There is code in both openfermion.transforms and openfermion.utils which facilitates this. The function get_sparse_operator converts either a FermionOperator, a QubitOperator or other more advanced classes such as InteractionOperator to a scipy.sparse.csc matrix. There are numerous functions in openfermion.utils which one can call on the sparse operators such as &quot;get_gap&quot;, &quot;get_hartree_fock_state&quot;, &quot;get_ground_state&quot;, etc. We show this off by computing the ground state energy of the Hubbard model. To do that, we use code from the openfermion.hamiltonians module which constructs lattice models of fermions such as Hubbard models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.hamiltonians</span> <span class="kn">import</span> <span class="n">fermi_hubbard</span>
<span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">get_sparse_operator</span><span class="p">,</span> <span class="n">get_ground_state</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">jordan_wigner</span>


<span class="c1"># Set model.</span>
<span class="n">x_dimension</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">y_dimension</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">tunneling</span> <span class="o">=</span> <span class="mf">2.</span>
<span class="n">coulomb</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">magnetic_field</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">chemical_potential</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">periodic</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">spinless</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Get fermion operator.</span>
<span class="n">hubbard_model</span> <span class="o">=</span> <span class="n">fermi_hubbard</span><span class="p">(</span>
    <span class="n">x_dimension</span><span class="p">,</span> <span class="n">y_dimension</span><span class="p">,</span> <span class="n">tunneling</span><span class="p">,</span> <span class="n">coulomb</span><span class="p">,</span> <span class="n">chemical_potential</span><span class="p">,</span>
    <span class="n">magnetic_field</span><span class="p">,</span> <span class="n">periodic</span><span class="p">,</span> <span class="n">spinless</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hubbard_model</span><span class="p">)</span>

<span class="c1"># Get qubit operator under Jordan-Wigner.</span>
<span class="n">jw_hamiltonian</span> <span class="o">=</span> <span class="n">jordan_wigner</span><span class="p">(</span><span class="n">hubbard_model</span><span class="p">)</span>
<span class="n">jw_hamiltonian</span><span class="o">.</span><span class="n">compress</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jw_hamiltonian</span><span class="p">)</span>

<span class="c1"># Get scipy.sparse.csc representation.</span>
<span class="n">sparse_operator</span> <span class="o">=</span> <span class="n">get_sparse_operator</span><span class="p">(</span><span class="n">hubbard_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sparse_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Energy of the model is </span><span class="si">{}</span><span class="s1"> in units of T and J.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">get_ground_state</span><span class="p">(</span><span class="n">sparse_operator</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="hamiltonians-in-the-plane-wave-basis">
<h2>Hamiltonians in the plane wave basis<a class="headerlink" href="#hamiltonians-in-the-plane-wave-basis" title="Link to this heading">#</a></h2>
<p>A user can write plugins to openfermion which allow for the use of, e.g., third-party electronic structure package to compute molecular orbitals, Hamiltonians, energies, reduced density matrices, coupled cluster amplitudes, etc using Gaussian basis sets. We may provide scripts which interface between such packages and openfermion in future but do not discuss them in this tutorial.</p>
<p>When using simpler basis sets such as plane waves, these packages are not needed. openfermion comes with code which computes Hamiltonians in the plane wave basis. Note that when using plane waves, one is working with the periodized Coulomb operator, best suited for condensed phase calculations such as studying the electronic structure of a solid. To obtain these Hamiltonians one must choose to study the system without a spin degree of freedom (spinless), one must the specify dimension in which the calculation is performed (n_dimensions, usually 3), one must specify how many plane waves are in each dimension (grid_length) and one must specify the length scale of the plane wave harmonics in each dimension (length_scale) and also the locations and charges of the nuclei. One can generate these models with plane_wave_hamiltonian() found in openfermion.hamiltonians. For simplicity, below we compute the Hamiltonian in the case of zero external charge (corresponding to the uniform electron gas, aka jellium). We also demonstrate that one can transform the plane wave Hamiltonian using a Fourier transform without effecting the spectrum of the operator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.hamiltonians</span> <span class="kn">import</span> <span class="n">jellium_model</span>
<span class="kn">from</span> <span class="nn">openfermion.utils</span> <span class="kn">import</span> <span class="n">Grid</span>
<span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">eigenspectrum</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">jordan_wigner</span><span class="p">,</span> <span class="n">fourier_transform</span>

<span class="c1"># Let&#39;s look at a very small model of jellium in 1D.</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">spinless</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Get the momentum Hamiltonian.</span>
<span class="n">momentum_hamiltonian</span> <span class="o">=</span> <span class="n">jellium_model</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">spinless</span><span class="p">)</span>
<span class="n">momentum_qubit_operator</span> <span class="o">=</span> <span class="n">jordan_wigner</span><span class="p">(</span><span class="n">momentum_hamiltonian</span><span class="p">)</span>
<span class="n">momentum_qubit_operator</span><span class="o">.</span><span class="n">compress</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">momentum_qubit_operator</span><span class="p">)</span>

<span class="c1"># Fourier transform the Hamiltonian to the position basis.</span>
<span class="n">position_hamiltonian</span> <span class="o">=</span> <span class="n">fourier_transform</span><span class="p">(</span><span class="n">momentum_hamiltonian</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">spinless</span><span class="p">)</span>
<span class="n">position_qubit_operator</span> <span class="o">=</span> <span class="n">jordan_wigner</span><span class="p">(</span><span class="n">position_hamiltonian</span><span class="p">)</span>
<span class="n">position_qubit_operator</span><span class="o">.</span><span class="n">compress</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">position_qubit_operator</span><span class="p">)</span>

<span class="c1"># Check the spectra to make sure these representations are iso-spectral.</span>
<span class="n">spectral_difference</span> <span class="o">=</span> <span class="n">eigenspectrum</span><span class="p">(</span><span class="n">momentum_qubit_operator</span><span class="p">)</span> <span class="o">-</span>  <span class="n">eigenspectrum</span><span class="p">(</span><span class="n">position_qubit_operator</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spectral_difference</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="basics-of-moleculardata-class">
<h2>Basics of MolecularData class<a class="headerlink" href="#basics-of-moleculardata-class" title="Link to this heading">#</a></h2>
<p>Data from electronic structure calculations can be saved in an OpenFermion data structure called MolecularData, which makes it easy to access within our library. Often, one would like to analyze a chemical series or look at many different Hamiltonians and sometimes the electronic structure calculations are either expensive to compute or difficult to converge (e.g. one needs to mess around with different types of SCF routines to make things converge). Accordingly, we anticipate that users will want some way to automatically database the results of their electronic structure calculations so that important data (such as the SCF integrals) can be looked up on-the-fly if the user has computed them in the past. OpenFermion supports a data provenance strategy which saves key results of the electronic structure calculation (including pointers to files containing large amounts of data, such as the molecular integrals) in an HDF5 container.</p>
<p>The MolecularData class stores information about molecules. One initializes a MolecularData object by specifying parameters of a molecule such as its geometry, basis, multiplicity, charge and an optional string describing it. One can also initialize MolecularData simply by providing a string giving a filename where a previous MolecularData object was saved in an HDF5 container. One can save a MolecularData instance by calling the class's .save() method. This automatically saves the instance in a data folder specified during OpenFermion installation. The name of the file is generated automatically from the instance attributes and optionally provided description. Alternatively, a filename can also be provided as an optional input if one wishes to manually name the file.</p>
<p>When electronic structure calculations are run, the data files for the molecule can be automatically updated. If one wishes to later use that data they either initialize MolecularData with the instance filename or initialize the instance and then later call the .load() method.</p>
<p>Basis functions are provided to initialization using a string such as &quot;6-31g&quot;. Geometries can be specified using a simple txt input file (see geometry_from_file function in molecular_data.py) or can be passed using a simple python list format demonstrated below. Atoms are specified using a string for their atomic symbol. Distances should be provided in angstrom. Below we initialize a simple instance of MolecularData without performing any electronic structure calculations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.chem</span> <span class="kn">import</span> <span class="n">MolecularData</span>

<span class="c1"># Set parameters to make a simple molecule.</span>
<span class="n">diatomic_bond_length</span> <span class="o">=</span> <span class="mf">.7414</span>
<span class="n">geometry</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">diatomic_bond_length</span><span class="p">))]</span>
<span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span>
<span class="n">multiplicity</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">description</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">diatomic_bond_length</span><span class="p">)</span>

<span class="c1"># Make molecule and print out a few interesting facts about it.</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">MolecularData</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">multiplicity</span><span class="p">,</span>
                         <span class="n">charge</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Molecule has automatically generated name </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">molecule</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Information about this molecule would be saved at:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">molecule</span><span class="o">.</span><span class="n">filename</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This molecule has </span><span class="si">{}</span><span class="s1"> atoms and </span><span class="si">{}</span><span class="s1"> electrons.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">molecule</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">molecule</span><span class="o">.</span><span class="n">n_electrons</span><span class="p">))</span>
<span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">atomic_number</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="n">molecule</span><span class="o">.</span><span class="n">protons</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Contains </span><span class="si">{}</span><span class="s1"> atom, which has </span><span class="si">{}</span><span class="s1"> protons.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">atom</span><span class="p">,</span> <span class="n">atomic_number</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>If we had previously computed this molecule using an electronic structure package, we can call molecule.load() to populate all sorts of interesting fields in the data structure. Though we make no assumptions about what electronic structure packages users might install, we assume that the calculations are saved in OpenFermion's MolecularData objects. Currently plugins are available for <a class="reference external" href="http://psicode.org/">Psi4</a> <a class="reference external" href="http://github.com/quantumlib/OpenFermion-Psi4">(OpenFermion-Psi4)</a> and <a class="reference external" href="https://github.com/sunqm/pyscf">PySCF</a> <a class="reference external" href="http://github.com/quantumlib/OpenFermion-PySCF">(OpenFermion-PySCF)</a>, and there may be more in the future. For the purposes of this example, we will load data that ships with OpenFermion to make a plot of the energy surface of hydrogen. Note that helper functions to initialize some interesting chemical benchmarks are found in openfermion.utils.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set molecule parameters.</span>
<span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span>
<span class="n">multiplicity</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">bond_length_interval</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">n_points</span> <span class="o">=</span> <span class="mi">25</span>

<span class="c1"># Generate molecule at different bond lengths.</span>
<span class="n">hf_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fci_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bond_lengths</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">bond_length</span> <span class="o">=</span> <span class="n">bond_length_interval</span> <span class="o">*</span> <span class="n">point</span>
    <span class="n">bond_lengths</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bond_length</span><span class="p">]</span>
    <span class="n">description</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">bond_length</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">))]</span>
    <span class="n">molecule</span> <span class="o">=</span> <span class="n">MolecularData</span><span class="p">(</span>
        <span class="n">geometry</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">multiplicity</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">)</span>
    
    <span class="c1"># Load data.</span>
    <span class="n">molecule</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="c1"># Print out some results of calculation.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">At bond length of </span><span class="si">{}</span><span class="s1"> angstrom, molecular hydrogen has:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">bond_length</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hartree-Fock energy of </span><span class="si">{}</span><span class="s1"> Hartree.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">hf_energy</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MP2 energy of </span><span class="si">{}</span><span class="s1"> Hartree.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">mp2_energy</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FCI energy of </span><span class="si">{}</span><span class="s1"> Hartree.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">fci_energy</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nuclear repulsion energy between protons is </span><span class="si">{}</span><span class="s1"> Hartree.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">molecule</span><span class="o">.</span><span class="n">nuclear_repulsion</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">orbital</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">n_orbitals</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spatial orbital </span><span class="si">{}</span><span class="s1"> has energy of </span><span class="si">{}</span><span class="s1"> Hartree.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">orbital</span><span class="p">,</span> <span class="n">molecule</span><span class="o">.</span><span class="n">orbital_energies</span><span class="p">[</span><span class="n">orbital</span><span class="p">]))</span>
    <span class="n">hf_energies</span> <span class="o">+=</span> <span class="p">[</span><span class="n">molecule</span><span class="o">.</span><span class="n">hf_energy</span><span class="p">]</span>
    <span class="n">fci_energies</span> <span class="o">+=</span> <span class="p">[</span><span class="n">molecule</span><span class="o">.</span><span class="n">fci_energy</span><span class="p">]</span>

<span class="c1"># Plot.</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">fci_energies</span><span class="p">,</span> <span class="s1">&#39;x-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bond_lengths</span><span class="p">,</span> <span class="n">hf_energies</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy in Hartree&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bond length in angstrom&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The geometry data needed to generate MolecularData can also be retrieved from the PubChem online database by inputting the molecule's name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.chem</span> <span class="kn">import</span> <span class="n">geometry_from_pubchem</span>

<span class="n">methane_geometry</span> <span class="o">=</span> <span class="n">geometry_from_pubchem</span><span class="p">(</span><span class="s1">&#39;methane&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">methane_geometry</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="interactionoperator-and-interactionrdm-for-efficient-numerical-representations">
<h2>InteractionOperator and InteractionRDM for efficient numerical representations<a class="headerlink" href="#interactionoperator-and-interactionrdm-for-efficient-numerical-representations" title="Link to this heading">#</a></h2>
<p>Fermion Hamiltonians can be expressed as <span class="math notranslate nohighlight">\(H = h_0 + \sum_{pq} h_{pq}\, a^\dagger_p a_q + \frac{1}{2} \sum_{pqrs} h_{pqrs} \, a^\dagger_p a^\dagger_q a_r a_s\)</span> where <span class="math notranslate nohighlight">\(h_0\)</span> is a constant shift due to the nuclear repulsion and <span class="math notranslate nohighlight">\(h_{pq}\)</span> and <span class="math notranslate nohighlight">\(h_{pqrs}\)</span> are the famous molecular integrals. Since fermions interact pairwise, their energy is thus a unique function of the one-particle and two-particle reduced density matrices which are expressed in second quantization as <span class="math notranslate nohighlight">\(\rho_{pq} = \left \langle p \mid a^\dagger_p a_q \mid q \right \rangle\)</span> and <span class="math notranslate nohighlight">\(\rho_{pqrs} = \left \langle pq \mid a^\dagger_p a^\dagger_q a_r a_s \mid rs \right \rangle\)</span>, respectively.</p>
<p>Because the RDMs and molecular Hamiltonians are both compactly represented and manipulated as 2- and 4- index tensors, we can represent them in a particularly efficient form using  similar data structures. The InteractionOperator data structure can be initialized for a Hamiltonian by passing the constant <span class="math notranslate nohighlight">\(h_0\)</span> (or 0), as well as numpy arrays representing <span class="math notranslate nohighlight">\(h_{pq}\)</span> (or <span class="math notranslate nohighlight">\(\rho_{pq}\)</span>) and <span class="math notranslate nohighlight">\(h_{pqrs}\)</span> (or <span class="math notranslate nohighlight">\(\rho_{pqrs}\)</span>). Importantly, InteractionOperators can also be obtained by calling MolecularData.get_molecular_hamiltonian() or by calling the function get_interaction_operator() (found in openfermion.transforms) on a FermionOperator. The InteractionRDM data structure is similar but represents RDMs. For instance, one can get a molecular RDM by calling MolecularData.get_molecular_rdm(). When generating Hamiltonians from the MolecularData class, one can choose to restrict the system to an active space.</p>
<p>These classes inherit from the same base class, PolynomialTensor. This data structure overloads the slice operator [] so that one can get or set the key attributes of the InteractionOperator: <span class="math notranslate nohighlight">\(\textrm{.constant}\)</span>, <span class="math notranslate nohighlight">\(\textrm{.one_body_coefficients}\)</span> and <span class="math notranslate nohighlight">\(\textrm{.two_body_coefficients}\)</span> . For instance, InteractionOperator[(p, 1), (q, 1), (r, 0), (s, 0)] would return <span class="math notranslate nohighlight">\(h_{pqrs}\)</span> and InteractionRDM would return <span class="math notranslate nohighlight">\(\rho_{pqrs}\)</span>. Importantly, the class supports fast basis transformations using the method PolynomialTensor.rotate_basis(rotation_matrix).
But perhaps most importantly, one can map the InteractionOperator to any of the other data structures we've described here.</p>
<p>Below, we load MolecularData from a saved calculation of LiH. We then obtain an InteractionOperator representation of this system in an active space. We then map that operator to qubits. We then demonstrate that one can rotate the orbital basis of the InteractionOperator using random angles to obtain a totally different operator that is still iso-spectral.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.chem</span> <span class="kn">import</span> <span class="n">MolecularData</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">get_fermion_operator</span><span class="p">,</span> <span class="n">jordan_wigner</span>
<span class="kn">from</span> <span class="nn">openfermion.linalg</span> <span class="kn">import</span> <span class="n">get_ground_state</span><span class="p">,</span> <span class="n">get_sparse_operator</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span>

<span class="c1"># Load saved file for LiH.</span>
<span class="n">diatomic_bond_length</span> <span class="o">=</span> <span class="mf">1.45</span>
<span class="n">geometry</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">diatomic_bond_length</span><span class="p">))]</span>
<span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span>
<span class="n">multiplicity</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Set Hamiltonian parameters.</span>
<span class="n">active_space_start</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">active_space_stop</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Generate and populate instance of MolecularData.</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">MolecularData</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">multiplicity</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;1.45&quot;</span><span class="p">)</span>
<span class="n">molecule</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="c1"># Get the Hamiltonian in an active space.</span>
<span class="n">molecular_hamiltonian</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_molecular_hamiltonian</span><span class="p">(</span>
    <span class="n">occupied_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">active_space_start</span><span class="p">),</span>
    <span class="n">active_indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">active_space_start</span><span class="p">,</span> <span class="n">active_space_stop</span><span class="p">))</span>

<span class="c1"># Map operator to fermions and qubits.</span>
<span class="n">fermion_hamiltonian</span> <span class="o">=</span> <span class="n">get_fermion_operator</span><span class="p">(</span><span class="n">molecular_hamiltonian</span><span class="p">)</span>
<span class="n">qubit_hamiltonian</span> <span class="o">=</span> <span class="n">jordan_wigner</span><span class="p">(</span><span class="n">fermion_hamiltonian</span><span class="p">)</span>
<span class="n">qubit_hamiltonian</span><span class="o">.</span><span class="n">compress</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Jordan-Wigner Hamiltonian in canonical basis follows:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">qubit_hamiltonian</span><span class="p">))</span>

<span class="c1"># Get sparse operator and ground state energy.</span>
<span class="n">sparse_hamiltonian</span> <span class="o">=</span> <span class="n">get_sparse_operator</span><span class="p">(</span><span class="n">qubit_hamiltonian</span><span class="p">)</span>
<span class="n">energy</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">get_ground_state</span><span class="p">(</span><span class="n">sparse_hamiltonian</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ground state energy before rotation is </span><span class="si">{}</span><span class="s1"> Hartree.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">energy</span><span class="p">))</span>

<span class="c1"># Randomly rotate.</span>
<span class="n">n_orbitals</span> <span class="o">=</span> <span class="n">molecular_hamiltonian</span><span class="o">.</span><span class="n">n_qubits</span> <span class="o">//</span> <span class="mi">2</span>
<span class="n">n_variables</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_orbitals</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_orbitals</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">random_angles</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_variables</span><span class="p">))</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_orbitals</span><span class="p">,</span> <span class="n">n_orbitals</span><span class="p">))</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_orbitals</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_orbitals</span><span class="p">):</span>
        <span class="n">kappa</span><span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">random_angles</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">kappa</span><span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">random_angles</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Build the unitary rotation matrix.</span>
    <span class="n">difference_matrix</span> <span class="o">=</span> <span class="n">kappa</span> <span class="o">+</span> <span class="n">kappa</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">kappa</span><span class="p">)</span>

    <span class="c1"># Apply the unitary.</span>
    <span class="n">molecular_hamiltonian</span><span class="o">.</span><span class="n">rotate_basis</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">)</span>

<span class="c1"># Get qubit Hamiltonian in rotated basis.</span>
<span class="n">qubit_hamiltonian</span> <span class="o">=</span> <span class="n">jordan_wigner</span><span class="p">(</span><span class="n">molecular_hamiltonian</span><span class="p">)</span>
<span class="n">qubit_hamiltonian</span><span class="o">.</span><span class="n">compress</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Jordan-Wigner Hamiltonian in rotated basis follows:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">qubit_hamiltonian</span><span class="p">))</span>

<span class="c1"># Get sparse Hamiltonian and energy in rotated basis.</span>
<span class="n">sparse_hamiltonian</span> <span class="o">=</span> <span class="n">get_sparse_operator</span><span class="p">(</span><span class="n">qubit_hamiltonian</span><span class="p">)</span>
<span class="n">energy</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">get_ground_state</span><span class="p">(</span><span class="n">sparse_hamiltonian</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ground state energy after rotation is </span><span class="si">{}</span><span class="s1"> Hartree.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">energy</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="quadratic-hamiltonians-and-slater-determinants">
<h2>Quadratic Hamiltonians and Slater determinants<a class="headerlink" href="#quadratic-hamiltonians-and-slater-determinants" title="Link to this heading">#</a></h2>
<p>The general electronic structure Hamiltonian
<span class="math notranslate nohighlight">\(H = h_0 + \sum_{pq} h_{pq}\, a^\dagger_p a_q + \frac{1}{2} \sum_{pqrs} h_{pqrs} \, a^\dagger_p a^\dagger_q a_r a_s\)</span> contains terms that act on up to 4 sites, or
is quartic in the fermionic creation and annihilation operators. However, in many situations
we may fruitfully approximate these Hamiltonians by replacing these quartic terms with
terms that act on at most 2 fermionic sites, or quadratic terms, as in mean-field approximation theory.<br />
These Hamiltonians have a number of
special properties one can exploit for efficient simulation and manipulation of the Hamiltonian, thus
warranting a special data structure.  We refer to Hamiltonians which
only contain terms that are quadratic in the fermionic creation and annihilation operators
as quadratic Hamiltonians, and include the general case of non-particle conserving terms as in
a general Bogoliubov transformation.  Eigenstates of quadratic Hamiltonians can be prepared
efficiently on both a quantum and classical computer, making them amenable to initial guesses for
many more challenging problems.</p>
<p>A general quadratic Hamiltonian takes the form
$<span class="math notranslate nohighlight">\(H = \sum_{p, q} (M_{pq} - \mu \delta_{pq}) a^\dagger_p a_q + \frac{1}{2} \sum_{p, q} (\Delta_{pq} a^\dagger_p a^\dagger_q + \Delta_{pq}^* a_q a_p) + \text{constant},\)</span><span class="math notranslate nohighlight">\(
where \)</span>M<span class="math notranslate nohighlight">\( is a Hermitian matrix, \)</span>\Delta<span class="math notranslate nohighlight">\( is an antisymmetric matrix,
\)</span>\delta_{pq}<span class="math notranslate nohighlight">\( is the Kronecker delta symbol, and \)</span>\mu<span class="math notranslate nohighlight">\( is a chemical
potential term which we keep separate from \)</span>M<span class="math notranslate nohighlight">\( so that we can use it
to adjust the expectation of the total number of particles.
In OpenFermion, quadratic Hamiltonians are conveniently represented and manipulated
using the QuadraticHamiltonian class, which stores \)</span>M<span class="math notranslate nohighlight">\(, \)</span>\Delta<span class="math notranslate nohighlight">\(, \)</span>\mu$ and the constant. It is specialized to exploit the properties unique to quadratic Hamiltonians. Like InteractionOperator and InteractionRDM, it inherits from the PolynomialTensor class.</p>
<p>The BCS mean-field model of superconductivity is a quadratic Hamiltonian. The following code constructs an instance of this model as a FermionOperator, converts it to a QuadraticHamiltonian, and then computes its ground energy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.hamiltonians</span> <span class="kn">import</span> <span class="n">mean_field_dwave</span>
<span class="kn">from</span> <span class="nn">openfermion.transforms</span> <span class="kn">import</span> <span class="n">get_quadratic_hamiltonian</span>

<span class="c1"># Set model.</span>
<span class="n">x_dimension</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">y_dimension</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">tunneling</span> <span class="o">=</span> <span class="mf">2.</span>
<span class="n">sc_gap</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">periodic</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Get FermionOperator.</span>
<span class="n">mean_field_model</span> <span class="o">=</span> <span class="n">mean_field_dwave</span><span class="p">(</span>
    <span class="n">x_dimension</span><span class="p">,</span> <span class="n">y_dimension</span><span class="p">,</span> <span class="n">tunneling</span><span class="p">,</span> <span class="n">sc_gap</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="n">periodic</span><span class="p">)</span>

<span class="c1"># Convert to QuadraticHamiltonian</span>
<span class="n">quadratic_hamiltonian</span> <span class="o">=</span> <span class="n">get_quadratic_hamiltonian</span><span class="p">(</span><span class="n">mean_field_model</span><span class="p">)</span>

<span class="c1"># Compute the ground energy</span>
<span class="n">ground_energy</span> <span class="o">=</span> <span class="n">quadratic_hamiltonian</span><span class="o">.</span><span class="n">ground_energy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ground_energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Any quadratic Hamiltonian may be rewritten in the form
$<span class="math notranslate nohighlight">\(H = \sum_p \varepsilon_p b^\dagger_p b_p + \text{constant},\)</span><span class="math notranslate nohighlight">\(
where the \)</span>b_p<span class="math notranslate nohighlight">\( are new annihilation operators that satisfy the fermionic anticommutation relations, and which are linear combinations of the old creation and annihilation operators. This form of \)</span>H<span class="math notranslate nohighlight">\( makes it easy to deduce its eigenvalues; they are sums of subsets of the \)</span>\varepsilon_p<span class="math notranslate nohighlight">\(, which we call the orbital energies of \)</span>H$. The following code computes the orbital energies and the constant:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">orbital_energies</span><span class="p">,</span> <span class="n">constant</span> <span class="o">=</span> <span class="n">quadratic_hamiltonian</span><span class="o">.</span><span class="n">orbital_energies</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orbital_energies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">constant</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Eigenstates of quadratic hamiltonians are also known as fermionic Gaussian states, and they can be prepared efficiently on a quantum computer. One can use OpenFermion to obtain circuits for preparing these states. The following code obtains the description of a circuit which prepares the ground state (operations that can be performed in parallel are grouped together), along with a description of the starting state to which the circuit should be applied:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.circuits</span> <span class="kn">import</span> <span class="n">gaussian_state_preparation_circuit</span>

<span class="n">circuit_description</span><span class="p">,</span> <span class="n">start_orbitals</span> <span class="o">=</span> <span class="n">gaussian_state_preparation_circuit</span><span class="p">(</span><span class="n">quadratic_hamiltonian</span><span class="p">)</span>
<span class="k">for</span> <span class="n">parallel_ops</span> <span class="ow">in</span> <span class="n">circuit_description</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">parallel_ops</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">start_orbitals</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the circuit description, each elementary operation is either a tuple of the form <span class="math notranslate nohighlight">\((i, j, \theta, \varphi)\)</span>, indicating the operation <span class="math notranslate nohighlight">\(\exp[i \varphi a_j^\dagger a_j]\exp[\theta (a_i^\dagger a_j - a_j^\dagger a_i)]\)</span>, which is a Givens rotation of modes <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, or the string 'pht', indicating the particle-hole transformation on the last fermionic mode, which is the operator <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> such that <span class="math notranslate nohighlight">\(\mathcal{B} a_N \mathcal{B}^\dagger = a_N^\dagger\)</span> and leaves the rest of the ladder operators unchanged. Operations that can be performed in parallel are grouped together.</p>
<p>In the special case that a quadratic Hamiltonian conserves particle number (<span class="math notranslate nohighlight">\(\Delta = 0\)</span>), its eigenstates take the form
$<span class="math notranslate nohighlight">\(\lvert \Psi_S \rangle = b^\dagger_{1}\cdots b^\dagger_{N_f}\lvert \text{vac} \rangle,\qquad
b^\dagger_{p} = \sum_{k=1}^N Q_{pq}a^\dagger_q,\)</span><span class="math notranslate nohighlight">\(
where \)</span>Q<span class="math notranslate nohighlight">\( is an \)</span>N_f \times N<span class="math notranslate nohighlight">\( matrix with orthonormal rows. These states are also known as Slater determinants. OpenFermion also provides functionality to obtain circuits for preparing Slater determinants starting with the matrix \)</span>Q$ as the input.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./myenv/openfermion/docs/tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目次
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Copyright 2020 The OpenFermion Developers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-openfermion">Introduction to OpenFermion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initializing-the-fermionoperator-data-structure">Initializing the FermionOperator data structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulating-the-fermionoperator-data-structure">Manipulating the FermionOperator data structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-qubitoperator-data-structure">The QubitOperator data structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jordan-wigner-and-bravyi-kitaev">Jordan-Wigner and Bravyi-Kitaev</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sparse-matrices-and-the-hubbard-model">Sparse matrices and the Hubbard model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonians-in-the-plane-wave-basis">Hamiltonians in the plane wave basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basics-of-moleculardata-class">Basics of MolecularData class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactionoperator-and-interactionrdm-for-efficient-numerical-representations">InteractionOperator and InteractionRDM for efficient numerical representations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quadratic-hamiltonians-and-slater-determinants">Quadratic Hamiltonians and Slater determinants</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  © Copyright 2025-present by 吉田 聡太 (Sota Yoshida). 本コンテンツは<a rel="license" href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0 ライセンス</a>の下に提供されています。 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>　ただし、資料中のコードセル部分は<a rel="license" href="https://opensource.org/licenses/MIT">MITライセンス</a>の下に提供されています。

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>